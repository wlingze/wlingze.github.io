(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{514:function(t,s,a){"use strict";a.r(s);var n=a(31),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"miasm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#miasm"}},[t._v("#")]),t._v(" miasm")]),t._v(" "),a("p",[t._v("æœ€å¼€å§‹æ¥è§¦åˆ°æ˜¯åœ¨fcscçš„keykoololé¢˜ç›®wpä¸­ï¼Œ ä½¿ç”¨miasmå¤„ç†ä¸€ä¸ªvmï¼Œ åŒæ—¶è„šæœ¬ä¸­å¹¶æ²¡æœ‰å‡ºç°å¯¹äº255ä¸ªopcodeå¯¹åº”çš„è®¾ç½®ï¼Œä½†æ˜¯å´åƒä¸€ä¸ªåæ±‡ç¼–å™¨ä¸€æ ·ç›´æ¥æ‰“å°å‡ºç±»æ±‡ç¼–ä»£ç ï¼Œä¼¼ä¹æŒºç¥å¥‡ï¼Œ è€Œååœ¨tigressæŒ‘æˆ˜ä¸­çš„challenge0ä¹Ÿåœ¨å…¶å®˜æ–¹blogæœ‰å¯¹åº”wpï¼Œ äºæ˜¯å¼€å§‹å­¦ä¹ ï¼Œ")]),t._v(" "),a("p",[t._v("è¿™ä¸ªæ¡†æ¶ç›®å‰ä¼¼ä¹è¿˜æ²¡æœ‰å¾ˆå®Œå¤‡çš„èµ„æ–™ï¼Œ å®˜æ–¹çš„blogç®€ä»‹äº†ä½¿ç”¨æ–¹å‘ï¼Œ ä½†æ˜¯å› ä¸ºç‰ˆæœ¬æ›´æ–°æœ‰äº›è„šæœ¬ç”šè‡³å‡ºç°äº†é—®é¢˜ï¼Œ")]),t._v(" "),a("p",[t._v("ç¿»åˆ°äº†ä¸€ä¸ªè¿™ä¸ªï¼Œ "),a("a",{attrs:{href:"https://miasmdoc.ajax.re/doxygen/html/namespacemiasm2.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("miasm - api"),a("OutboundLink")],1),t._v("ä½†æ˜¯æ¯”è¾ƒè€ï¼Œè¿™ä¸ªæ¡†æ¶æ›´æ–°è¿˜æ˜¯æ¯”è¾ƒé¢‘ç¹ï¼Œ å¦å¤–å°±æ˜¯å¯¹ç…§"),a("a",{attrs:{href:"https://github.com/cea-sec/miasm",target:"_blank",rel:"noopener noreferrer"}},[t._v("æºç "),a("OutboundLink")],1),t._v("ä¸­çš„æ³¨é‡Šè¿›è¡Œå­¦ä¹ ï¼Œ æ³¨é‡Šå€’æ˜¯æ¯”è¾ƒå¤šï¼Œ è€Œä¸”ä»£ç è´¨é‡æ„Ÿè§‰ä¹Ÿæ¯”è¾ƒä¸é”™ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("è¿™ä¸ªæ¡†æ¶çš„å­¦ä¹ è¿‡ç¨‹ä¸­å¯¹äºæºç çš„ç¿»çœ‹æ›´å¤šäº†äº›ï¼Œ æ²¡æœ‰ä¸€äº›ç›¸å…³èµ„æ–™ï¼Œ ä½¿ç”¨èµ·æ¥çš„ä¸€äº›æŠ¥é”™ï¼Œ é€šè¿‡ç›´æ¥æŸ¥æ‰¾æºç ä¸­çš„æ³¨é‡Šå’Œå›æ˜¾ä¿¡æ¯ç­‰è¿›è¡Œè§£å†³ã€‚")])]),t._v(" "),a("p",[t._v("é¦–å…ˆåº”è¯¥æ¯”è¾ƒä¸åŒçš„æ˜¯è¿™ä¸ªåŠ¨æ€ç¬¦å·æ‰§è¡ŒæŠ€æœ¯ï¼Œ å³æ··åˆä½¿ç”¨ç¬¦å·æ‰§è¡Œå’Œæ™®é€šçš„è¾“å…¥ç¡®å®šå€¼çš„è°ƒè¯•ï¼Œ")]),t._v(" "),a("p",[t._v("ä¸»è¦æ€è·¯å¤§è‡´æ˜¯ï¼Œå› ä¸ºç¬¦å·æ‰§è¡Œä¼šå®¹æ˜“é€ æˆè·¯å¾„çˆ†ç‚¸çš„é—®é¢˜ï¼Œ äºæ˜¯æå‡ºï¼Œ å…ˆæ¨¡æ‹Ÿç¨‹åºçš„æ­£å¸¸æ‰§è¡Œï¼Œ ç„¶ååªåœ¨å…³é”®éœ€è¦çš„ä½ç½®æ’å…¥ç¬¦å·å¹¶åœ¨å¦ä¸€ç«¯çš„å¯¹åº”ä½ç½®å–å‡ºï¼Œ ç”±æ­¤é€šè¿‡è¾“å…¥çš„ç¡®å®šå€¼ä½¿å¾—è¿è¡Œè¿‡ç¨‹æ˜¯å›ºå®šçš„ï¼Œ ä¸ä¼šæœ‰è·¯å¾„çˆ†ç‚¸çš„æƒ…å†µï¼Œè€ŒåŒæ—¶ä½¿ç”¨ç¬¦å·è®°å½•è¿ç®—å¤„ç†è¿‡ç¨‹ï¼Œ æ ‡è®°è·¯å¾„ï¼Œ å¹¶è‡ªåŠ¨çš„é€šè¿‡å†…ç½®çš„irè½¬åŒ–ä¸ºç±»æ±‡ç¼–çš„è¯­è¨€ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("å› æ­¤ï¼Œ è¿™ä¸ªè„šæœ¬å†™èµ·æ¥ï¼Œ æœ‰ç‚¹åƒida pythonåŠ¨è°ƒçš„è„šæœ¬ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"è¿è¡Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¿è¡Œ"}},[t._v("#")]),t._v(" è¿è¡Œ")]),t._v(" "),a("p",[t._v("é¦–å…ˆæ˜¯è¦ä¿è¯ç¨‹åºåœ¨æ¡†æ¶ç»™å‡ºçš„ç¯å¢ƒå†…å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œ è¦è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼Œ è¿è¡Œè„šæœ¬å¹¶æŒ‡å®šå¯¹åº”ç¨‹åºï¼Œ é™¤äº†miasmæ¡†æ¶å¯¹åº”çš„æç¤ºä¿¡æ¯ï¼Œè¾“å…¥è¾“å‡ºè¿ç®—åˆ¤æ–­åº”è¯¥æ˜¯å’Œç›´æ¥è¿è¡Œç¨‹åºæ— äºŒã€‚")]),t._v(" "),a("h3",{attrs:{id:"sandbox"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sandbox"}},[t._v("#")]),t._v(" sandbox")]),t._v(" "),a("p",[t._v("é¦–å…ˆæ˜¯ä¸€ä¸ªè¿è¡Œç¯å¢ƒçš„è®¾ç½®ï¼Œmiasm ä¸­ä½¿ç”¨sandboxçš„æ¦‚å¿µï¼Œï¼Œmiasmåœ¨"),a("code",[t._v("/miasm/analysis/sandbox.py")]),t._v("é¢„è®¾å¥½äº†ä»¥ä¸‹å‡ ä¸ªsandboxï¼š")]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("details")]),t._v(" "),a("ul",[a("li",[t._v("å¯¹äºlinuxç³»ç»Ÿï¼š\n"),a("ul",[a("li",[t._v("aarch64l")]),t._v(" "),a("li",[t._v("armb_str")]),t._v(" "),a("li",[t._v("arml_str")]),t._v(" "),a("li",[t._v("arml")]),t._v(" "),a("li",[t._v("armtl")]),t._v(" "),a("li",[t._v("mips32b")]),t._v(" "),a("li",[t._v("ppc32b")]),t._v(" "),a("li",[t._v("x86_32")]),t._v(" "),a("li",[t._v("x86_64")])])]),t._v(" "),a("li",[t._v("å¯¹äºwindowsç³»ç»Ÿï¼š\n"),a("ul",[a("li",[t._v("x86_64")]),t._v(" "),a("li",[t._v("x86_32")])])])])]),t._v(" "),a("p",[t._v("ä½¿ç”¨å°±å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  miasm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("analysis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sandbox "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Sandbox_Linux_x86_64\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("ç„¶åè¿›è¡Œç®€å•è®¾ç½®ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("parser "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sandbox_Linux_x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("description"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ELF sandboxer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nparser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_argument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filename"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("help")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ELF Filename"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\noptions "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" parser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parse_args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nsb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sandbox_Linux_x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("filename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("globals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nsb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("é¦–å…ˆæ˜¯è·å–parserå¯¹è±¡ï¼Œ å…¶ä½œç”¨æ˜¯å¤„ç†è¿è¡Œè„šæœ¬æ—¶çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œç„¶åä½¿ç”¨optionsè·å–åˆ°è§£æå‡ºå‘½ä»¤è¡Œå‚æ•°çš„namespaceï¼Œ ç„¶åè®¾ç½®å‡ºsandboxå¯¹è±¡ï¼Œå¹¶å¼€å§‹è¿è¡Œå³å¯ã€‚")]),t._v(" "),a("h3",{attrs:{id:"æ•°æ®å’Œå†…å­˜å¤„ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®å’Œå†…å­˜å¤„ç†"}},[t._v("#")]),t._v(" æ•°æ®å’Œå†…å­˜å¤„ç†")]),t._v(" "),a("p",[t._v("ä¸»è¦é€šè¿‡sandbox.jitterï¼Œ è¿™æ˜¯ä¸€ä¸ªjitterå¯¹è±¡ï¼Œ æ˜¯è¿è¡Œæ—¶å†…ç½®çš„ä¸€ä¸ªjit engineï¼Œ é€šè¿‡è¿™ä¸ªå¯ä»¥è®¿é—®å’Œä¿®æ”¹æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å†…å­˜ã€‚ ç›¸å…³çš„å‡½æ•°åœ¨pythonä¸­å®šä¹‰åœ¨"),a("code",[t._v("/miasm/jitter/jitload.py")]),t._v("ï¼Œ åŸºæœ¬ä¸Šå…¨éƒ¨ä¼šè½¬å…¥åˆ°jitter.vmå¯¹è±¡ï¼Œ è¿™ä¸ªå¯¹è±¡ä¸»è¦æ˜¯"),a("code",[t._v("/miasm/jitter/vm_mngr.c")]),t._v(", "),a("code",[t._v("/miasm/jitter/vm_mngr_py.c")]),t._v("ä¸­ï¼Œ")]),t._v(" "),a("p",[t._v("å…¶ä¸­pythonä¸­å®šä¹‰çš„"),a("code",[t._v("jitter.get_c_str")]),t._v("å’Œ"),a("code",[t._v("jitter.set_c_str")]),t._v("éƒ½ä¼šè½¬åˆ°"),a("code",[t._v("jitter.vm.get_mem")]),t._v("å’Œ"),a("code",[t._v("jitter.vm.set_mem")]),t._v("ï¼Œ è¿™æ˜¯æœ€å¸¸ç”¨çš„å››ä¸ªï¼Œ ä¸€èˆ¬ç”¨åœ¨å¯¹libcå‡½æ•°çš„å®ç°ã€‚")]),t._v(" "),a("p",[t._v("å¦å¤–å¯¹äºå†…å­˜é¡µç­‰çš„å®ç°ï¼Œ æœ‰"),a("code",[t._v("jitter.vm.add_memory_page")]),t._v("è¿›è¡Œå†…å­˜é¡µçš„è®¾ç½®ï¼Œ ä¸€èˆ¬å‡ºç°canaryçš„æ—¶å€™ä»fs[0x28]å–å€¼ï¼Œ å°†ä¼šä½¿ç”¨è¿™ä¸ªå¤„ç†ï¼Œä¸ç„¶ç¨‹åºæ— æ³•è®¿é—®åˆ°fs[0x28]çš„ä½ç½®ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å®ç°-libc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-libc"}},[t._v("#")]),t._v(" å®ç° libc")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("warning")]),t._v(" "),a("p",[t._v("å’Œangrç±»ä¼¼ï¼Œ è¿™ä¸ªç¨‹åºè¿è¡Œåœ¨pythonçš„miasmæ¡†æ¶çš„ç¯å¢ƒå†…ï¼Œå¦‚æœä»–è°ƒç”¨äº†libcå‡½æ•°ï¼Œéƒ½æ— æ³•æ‰¾åˆ°ï¼Œ å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨miasmç¯å¢ƒä¸­æ„é€ è¿™ä¸ªå‡½æ•°ï¼Œåœ¨miasmä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è„šæœ¬ä¸­è®¾ç½®ä¸€ä¸ªå¯¹åº”çš„å‡½æ•°å³å¯ï¼Œè¿è¡Œæ—¶ä¼šè‡ªåŠ¨å¯»æ‰¾å’Œè°ƒç”¨ã€‚")]),t._v(" "),a("p",[t._v("ç›®å‰åº”è¯¥"),a("code",[t._v("__libc_start_main")]),t._v("è¿˜æœ‰å‡ ä¸ªä¸éœ€è¦ï¼Œ")]),t._v(" "),a("p",[t._v("å¯ä»¥ç›´æ¥è¿è¡Œï¼Œ çœ‹æŠ¥é”™æç¤ºç¼ºå°‘ï¼Œ å†ä¿®å¤å‡ ä¸ªï¼Œ")])]),t._v(" "),a("p",[t._v("åœ¨miasmä¸­å·²ç»å®ç°äº†å¥½å‡ ä¸ªï¼Œä½ç½®åœ¨"),a("code",[t._v("/miasm/os_dep/linux_stdlib.py")]),t._v("ï¼Œ å¯ä»¥"),a("code",[t._v("import Ã—")]),t._v("è¿›æ¥ï¼Œ ä½†æ˜¯å¯èƒ½ä¹Ÿä¼šå› ä¸ºå‡½æ•°åå’Œæå–å‚æ•°å•¥çš„ä¸å¯¹ï¼Œ")]),t._v(" "),a("p",[t._v("è¿™é‡Œç®€å•è¯´æ˜å‡ ä¸ªlibcå‡½æ•°çš„æ„é€ ï¼Œ")]),t._v(" "),a("p",[t._v("é¦–å…ˆä¼ å…¥å‡½æ•°çš„åº”è¯¥æ˜¯"),a("code",[t._v("jitter")]),t._v("ï¼Œ è¿™ä¸ªæˆ‘ä»¬å‰é¢è¯´é“çš„è·å–å­—ç¬¦ä¸²æˆ–è€…å†…å­˜å•¥çš„ï¼Œä¹ŸåŸºæœ¬éƒ½æ˜¯åœ¨è¿™é‡Œä½¿ç”¨çš„ã€‚")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" xxx_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tret_ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func_args_systemv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func_ret_systemv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ret_ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("ä¸€èˆ¬ä¸€ä¸ªæ¨¡æ‹Ÿlibcå‡½æ•°åº”è¯¥å¦‚ä¸Šç¤ºï¼Œ")]),t._v(" "),a("p",[t._v("å…³äºå‡½æ•°å¯¹åº”çš„å‚æ•°å’Œè¿”å›å€¼çš„è·å–å’Œè®¾ç½®ï¼Œ ä¸­é—´è¿›è¡Œæ•°æ®å¤„ç†ï¼Œ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¹Ÿå¹¶ä¸éœ€è¦ç¼–å†™éå¸¸å®Œå¤‡çš„å‡½æ•°åŠŸèƒ½ï¼Œ åªè¦ç¬¦åˆå½“å‰ç¨‹åºåº”è¯¥è¿è¡Œçš„çŠ¶æ€å³å¯ï¼Œ")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("tip")]),t._v(" "),a("p",[t._v("æ¯”å¦‚åœ¨æœ‰äº›ç¨‹åºé‡Œï¼Œ printfé‡Œä»æ²¡æœ‰å‡ºç°æ ¼å¼åŒ–å­—ç¬¦ä¸²+å‚æ•°çš„å½¢å¼ï¼Œ é‚£å°±å¯ä»¥åœ¨å®ç°çš„æ—¶å€™å½“ä½œä¸€ä¸ªputsä¹‹ç±»çš„ï¼Œ ç®€å•å®ç°å…¶åŠŸèƒ½ï¼Œ")])]),t._v(" "),a("p",[t._v("å…·ä½“çš„ä¾‹å­å¯ä»¥ç¿»çœ‹"),a("code",[t._v("linux_stdlib.py")]),t._v("æ–‡ä»¶ä¸­ï¼Œæˆ–è€…åœ¨å®é™…æ“ä½œä¸­çš„è„šæœ¬ï¼Œ")]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("details")]),t._v(" "),a("p",[t._v("è¿™é‡Œç®€å•ä¾‹å­:")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("xxx_fgets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("'''\n\t\tåŸå‹ï¼š char *fgets(char *str, int n, FILE *stream)\n\t\tåœ¨ç¨‹åºä¸­streamä¸€ç›´ä¸ºstdin, å› æ­¤ç›´æ¥ç”¨inputäº†ï¼Œ \n\t'''")]),t._v("\n    ret_ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func_args_systemv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stream"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("input")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_mem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func_ret_systemv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ret_ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("xxx___printf_chk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("'''\n    \tåŸå‹ï¼šint printf(const char *format, ...)\n    \tå€¼å¾—æ³¨æ„çš„æ˜¯å‚æ•°é‡Œçš„'s'ï¼Œ å¿…é¡»åŠ ä¸Šå°±æ­£ç¡®äº†ï¼Œ ä½†æ˜¯ä¸æ¸…æ¥šå•¥åŸå› ã€‚\n    '''")]),t._v("\n    ret_ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func_args_systemv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"format"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"arg"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_c_str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func_ret_systemv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ret_ad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br")])])]),t._v(" "),a("h3",{attrs:{id:"å‘½ä»¤è¡Œå‚æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‘½ä»¤è¡Œå‚æ•°"}},[t._v("#")]),t._v(" å‘½ä»¤è¡Œå‚æ•°")]),t._v(" "),a("p",[t._v("å¯¹äºç¨‹åºè¿è¡Œæ—¶éœ€è¦å‘½ä»¤è¡Œè¾“å…¥çš„å‚æ•°ï¼Œ")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mimic_env "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Ture\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("è¿™ä¸ªå˜é‡æ˜¯åœ¨Sandbox_Linux_x86_64å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶è·å–å‘½ä»¤è¡Œå‚æ•°ï¼Œå‹å…¥æ ˆä¸­ã€‚"),a("a",{attrs:{href:"https://github.com/cea-sec/miasm/blob/master/miasm/analysis/sandbox.py#L641",target:"_blank",rel:"noopener noreferrer"}},[t._v("åœ¨è¿™é‡Œ"),a("OutboundLink")],1),t._v(",")]),t._v(" "),a("p",[t._v("ç„¶åè¾“å…¥å‘½ä»¤è¡Œå‚æ•°ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("command_line "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'....'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"å†…å­˜æ®µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æ®µ"}},[t._v("#")]),t._v(" å†…å­˜æ®µ")]),t._v(" "),a("p",[t._v("ä¸€èˆ¬ä½¿ç”¨æ ˆç­‰éƒ½ä¸ä¼šæœ‰å¤ªå¤§é—®é¢˜ï¼Œ ä½†æ˜¯å½“ç¨‹åºä½¿ç”¨canaryæ—¶ï¼Œ å°†ä¼šå¯¼è‡´é—®é¢˜ï¼Œ äºæ˜¯æˆ‘ä»¬è¦æ‰‹åŠ¨è®¾ç½®fsçš„å†…å­˜å’Œcanaryæ‰€å–çš„ fs[0x28]ä½ç½®çš„æ•°æ®ï¼Œ")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" miasm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("csts      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" PAGE_READ\n\n\nsb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ir_arch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("do_all_segm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nFS_0_ADDR "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x7ff70000")]),t._v("\nsb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x4")]),t._v("\nsb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_segm_base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" FS_0_ADDR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_memory_page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FS_0_ADDR "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x28")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PAGE_READ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('b"\\x42\\x42\\x42\\x42\\x42\\x42\\x42\\x42"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Stack canary FS[0x28]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[t._v("åœ¨"),a("code",[t._v("miasm.jitter.csts")]),t._v("ä¸­å®šä¹‰çš„éƒ½æ˜¯ä¸€å †çš„å…³äºæƒé™æ§åˆ¶ç­‰å¸¸é‡ï¼Œ")]),t._v(" "),a("h2",{attrs:{id:"dse-æŠ€æœ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dse-æŠ€æœ¯"}},[t._v("#")]),t._v(" dse æŠ€æœ¯")]),t._v(" "),a("p",[t._v("å½“æˆ‘ä»¬å·²ç»æˆåŠŸå¯ä»¥è®©ç¨‹åºæ­£å¸¸çš„åœ¨miasmç¯å¢ƒä¸­è¿è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥å¼€å§‹è€ƒè™‘åŠ å…¥dse engineï¼Œ")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" miasm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("analysis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dse "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" DSEEngine\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"åˆå§‹åŒ–å’Œè®¾ç½®dse"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–å’Œè®¾ç½®dse"}},[t._v("#")]),t._v(" åˆå§‹åŒ–å’Œè®¾ç½®dse")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("dse "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DSEEngine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("machine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_lib_handler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("libs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("globals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("è¿™ä¸ªdse engineå¯¹è±¡å®šä¹‰åœ¨"),a("code",[t._v("/miasm/analysis/dse.py")]),t._v("ï¼Œ åˆå§‹åŒ–ä¼ å…¥sandboxå†…å¯¹åº”çš„machineå±æ€§å³å¯ï¼Œ")]),t._v(" "),a("p",[t._v("æ³¨æ„è¿™ä¸ª"),a("code",[t._v("dse.add_lib_handler(sb.libs, globals())")]),t._v("æ–¹æ³•ï¼Œ ä½œç”¨æ˜¯è½½å…¥dseåï¼Œ æ‰€æœ‰çš„libcå‡½æ•°ï¼Œ å¦‚å‡½æ•°"),a("code",[t._v("{name}")]),t._v(", è®¾ç½®åˆ°å¯¹åº”çš„"),a("code",[t._v("{name}_symb")]),t._v("å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰æŸ¥æ‰¾åˆ°å¯¹åº”çš„"),a("code",[t._v("{name}_symb")]),t._v("ï¼Œ åˆ™ä¼šè®¾ç½®åˆ°"),a("a",{attrs:{href:"https://github.com/cea-sec/miasm/blob/master/miasm/analysis/dse.py#L260",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("default_func")]),t._v("å‡½æ•°"),a("OutboundLink")],1),t._v(", æç¤ºè¿™ä¸ªå‡½æ•°ä¸å­˜åœ¨ï¼Œéœ€è¦å®šä¹‰ã€‚")]),t._v(" "),a("p",[t._v("æ³¨æ„è¿™é‡Œè®¾ç½®çš„æ˜¯handlerï¼Œ æœ€å"),a("code",[t._v("add_lib_handler")]),t._v("ä¼šè§£æå‡ºåå­—ä»¥åè°ƒç”¨"),a("code",[t._v("add_handler")]),t._v("è®¾ç½®ï¼Œ")]),t._v(" "),a("h3",{attrs:{id:"dse-attachåˆ°jitter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dse-attachåˆ°jitter"}},[t._v("#")]),t._v(" dse attachåˆ°jitter")]),t._v(" "),a("p",[t._v("å®šä¹‰å¥½dseå¯¹è±¡ä»¥åï¼Œè¿è¡Œä»ç„¶æ˜¯è€æ ·å­ï¼Œè¦æƒ³å¼€å§‹è®°å½•ç¬¦å·åº”è¯¥ä½¿ç”¨:")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("dse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("è¿™ä¸€å¥å¼€å§‹æˆ‘ä»¬çš„dseå¯¹è±¡æ‰ä¼šæŠ•å…¥ä½¿ç”¨ï¼Œè€Œä¸”è¿™ä»¥åçš„è°ƒç”¨libcéƒ½ä¼šæ˜¯è°ƒç”¨å¯¹åº”çš„"),a("code",[t._v("{name}_symb")]),t._v("å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰çš„è¯ä¹Ÿä¼šå¼€å§‹çœ‹åˆ°ç›¸å…³æŠ¥é”™äº†ã€‚")]),t._v(" "),a("p",[t._v("å…³äºè¿™ä¸€å¥çš„ä½ç½®ï¼Œå®šä¹‰å¥½dseä»¥åå°±å¯ä»¥ä½¿ç”¨attachï¼Œä½†æ˜¯ä¸€èˆ¬ä½¿ç”¨åœ¨å…³é”®ä½ç½®é™„è¿‘çš„libcå‡½æ•°è®¾ç½®ä¸€ä¸ªï¼Œ åœ¨å‡½æ•°å†…ä½¿ç”¨å¯ä»¥åŠ ä¸€ä¸ª"),a("code",[t._v("global dse")]),t._v("ã€‚")]),t._v(" "),a("h3",{attrs:{id:"instrumentationå’Œhandlerç›¸å…³"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#instrumentationå’Œhandlerç›¸å…³"}},[t._v("#")]),t._v(" instrumentationå’Œhandlerç›¸å…³")]),t._v(" "),a("p",[t._v("è®¾ç½®å¥½dseå’Œattachä»¥åå¯ä»¥å¼€å§‹è®¾ç½®ä½¿ç”¨instrumentationå’Œhandlerï¼Œè¿™æ˜¯dseå¯¹è±¡å†…çš„ä¸¤ä¸ªå­—å…¸ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /miasm/analysis/dse.py ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# class DSEEnigne ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\tself"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handler "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# addr -> callback(DSEEngine instance)")]),t._v("\n\tself"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("instrumentation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# addr -> callback(DSEEngine instance)")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""Add a @callback for address @addr before any state update.\n    The state IS NOT updated after returning from the callback\n    @addr: int\n    @callback: func(dse instance)"""')]),t._v("\n    self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add_instrumentation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""Add a @callback for address @addr before any state update.\n    The state IS updated after returning from the callback\n    @addr: int\n    @callback: func(dse instance)"""')]),t._v("\n    self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("instrumentation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])]),a("p",[t._v("é‡Œé¢å‚¨å­˜çš„æ˜¯åœ°å€å’Œå¯¹åº”è°ƒç”¨çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬ä¸­è®¾ç½®å¥½ä¸€ä¸ªå‡½æ•°ï¼Œ ç„¶åä½¿ç”¨"),a("code",[t._v("dse.add_instrumentation")]),t._v("æˆ–"),a("code",[t._v("dse.add_handler")]),t._v("è®¾ç½®åœ°å€å’Œè¿™ä¸ªå‡½æ•°ï¼Œ")]),t._v(" "),a("p",[t._v("è¿™ä¸¤ä¸ªå­—å…¸çš„ä½¿ç”¨çœ‹èµ·æ¥åŸºæœ¬ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯handleä¸ä¼šåˆ·æ–°çŠ¶æ€ï¼Œ instrumentationä¼šåˆ·æ–°çŠ¶æ€,")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("warning")]),t._v(" "),a("p",[t._v("å å‘")]),t._v(" "),a("p",[t._v("ç›®å‰ä¸å¤ªæ¸…æ¥šè¿™ä¸ªå…³äºçŠ¶æ€åˆ·æ–°çš„æ³¨é‡Šå•¥æ„æ€ğŸ˜… ğŸ˜…ğŸ˜…")]),t._v(" "),a("p",[t._v("ä¸è¿‡çœ‹åˆ°ç›¸å…³å‡ ä¸ªä¾‹å­ï¼Œ ä¸€èˆ¬æ‰‹åŠ¨è®¾ç½®ç¨‹åºä¸­çš„æŸäº›ä½ç½®çš„æ—¶å€™ä¼¼ä¹éƒ½æ˜¯ä½¿ç”¨instrumentationï¼Œ")]),t._v(" "),a("p",[t._v("å½“ç„¶ï¼Œè¿˜æœ‰ä¸ªupdate_stateçš„æ–¹æ³•ï¼Œ ä½†æ˜¯çœ‹èµ·æ¥å¹¶ä¸ä¸€æ ·...")])]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("details")]),t._v(" "),a("p",[t._v("ç›®å‰å·²ç»çœ‹åˆ°çš„ï¼Œ jitterä¸­è¿è¡Œåˆ°å¯¹åº”ä¸€äº›ä½ç½®åº”è¯¥æ˜¯å›å»è°ƒç”¨dseå¯¹è±¡çš„"),a("a",{attrs:{href:"https://github.com/cea-sec/miasm/blob/master/miasm/analysis/dse.py#L320",target:"_blank",rel:"noopener noreferrer"}},[t._v("callbackå‡½æ•°"),a("OutboundLink")],1),t._v("ï¼Œå…¶ä¸­ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /miasm/analysis/dse.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# class DSEEinge")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     def callback():")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" cur_addr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("cur_addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" cur_addr "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("instrumentation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("instrumentation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("cur_addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("è¿™é‡Œæ˜¯å…³äºè¿è¡Œè®¾ç½®å¥½çš„å‡½æ•°çš„ä½ç½®ï¼Œ å› æ­¤å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è®¾ç½®çš„å‡½æ•°åº”è¯¥å‚æ•°ä¸ºdseå¯¹è±¡ï¼Œ")]),t._v(" "),a("p",[t._v("å¦å¤–ä¸€ç‚¹å°±æ˜¯åœ¨handlerè¿è¡Œåç›´æ¥returnï¼Œ ä½†æ˜¯å¯¹äºinstrumentationè¿è¡Œåç»§ç»­è¿è¡Œäº†åé¢çš„éƒ¨åˆ†åœ¨æœ€åè¿›è¡Œè¿”å›ï¼Œè¿™åº”è¯¥å°±æ˜¯ä¸¤è€…çš„å·®åˆ«ä½ç½®ï¼Œä¹Ÿæ˜¯å…³äºçŠ¶æ€åˆ·æ–°ä¹‹ç±»çš„ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"ç¬¦å·åŒ–-å’Œ-çŠ¶æ€åˆ·æ–°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¦å·åŒ–-å’Œ-çŠ¶æ€åˆ·æ–°"}},[t._v("#")]),t._v(" ç¬¦å·åŒ– å’Œ çŠ¶æ€åˆ·æ–°")]),t._v(" "),a("p",[t._v("ç±»ä¼¼z3ä¸­è®¾ç½®ç¬¦å·çš„æ–¹å¼ï¼Œ miasmä¸­ä½¿ç”¨"),a("code",[t._v("Expr")]),t._v("ç³»åˆ—çš„å¯¹è±¡ï¼Œæ˜¯miasmä¸­çš„irä¸­é—´è¯­è¨€çš„è¡¨ç¤ºï¼Œ")]),t._v(" "),a("p",[t._v("ä¸€èˆ¬è¿™æ ·ä¸€ä¸ªå¯¹è±¡è¡¨ç¤ºä¸€ä¸ªç¬¦å·åŒ–çš„å˜é‡ï¼Œé€šè¿‡"),a("code",[t._v("dse.update_state()")]),t._v("æ–¹æ³•æ’å…¥åˆ°ç¨‹åºä¸­ï¼Œé€šè¿‡"),a("code",[t._v("dse.eval_expr()")]),t._v("æ–¹æ³•è·å–è¾“å…¥åçš„å·²ç»è®°å½•äº†è¿ç®—çš„ä¸€ä¸ªå¸¦ç¬¦å·è¡¨è¾¾å¼ï¼Œ")]),t._v(" "),a("p",[t._v("æ³¨æ„åœ¨æ’å…¥æ‰€æœ‰ç¬¦å·å‰ï¼Œ åº”è¯¥åœ¨attachä»¥åï¼Œä½¿ç”¨"),a("code",[t._v("dse.update_state_from_concrete()")]),t._v("ï¼Œ ä»åŸæœ¬çš„ç”±ç¡®å®šå€¼è¿è¡Œçš„ç¯å¢ƒä¸­è½½å…¥åˆ°dseç¯å¢ƒã€‚")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("tip")]),t._v(" "),a("p",[t._v("æœ€ç®€å•çš„ä¸€ä¸ªç¤ºä¾‹æ˜¯miasm-blogä¸­çš„tigress0-challenge0çš„å¤„ç†ï¼Œåœ¨æ–‡ç« "),a("a",{attrs:{href:"https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Playing with Dynamic symbolic execution"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("æˆ‘ä¸‹ä¸€æ­¥ä¹Ÿå°†ä¼šåœ¨åšå®¢çš„wpåŒº, tigress0-0ä¸­å†™ä¸Šå¯¹åº”çš„wp")])]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("dse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update_state_from_concrete"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update_state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exal_expr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h3",{attrs:{id:"è·å–å’Œè®¾ç½®å¯„å­˜å™¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è·å–å’Œè®¾ç½®å¯„å­˜å™¨"}},[t._v("#")]),t._v(" è·å–å’Œè®¾ç½®å¯„å­˜å™¨")]),t._v(" "),a("p",[t._v("åœ¨åŠ å…¥dseä»¥åï¼Œç¯å¢ƒä¸­ä¸€å…±å­˜åœ¨ä¸¤å¥—æ•°æ®ï¼Œ ä¸€ä¸ªæ˜¯åŸæœ¬çš„å…·ä½“å€¼ï¼Œ ä¸€ä¸ªæ˜¯ç¬¦å·åŒ–çš„æ•°æ®ã€‚")]),t._v(" "),a("p",[t._v("å…·ä½“å€¼ï¼Œé€šè¿‡"),a("code",[t._v("dse.jitter.cpu.xx")]),t._v("è®¿é—®å¯„å­˜å™¨ï¼Œ æˆ–è€…"),a("code",[t._v("sb.jitter.cpu.xx")]),t._v("è¿™ä¸¤ä¸ªæ˜¯ç­‰åŒçš„ã€‚ è¿”å›å€¼æ˜¯ä¸€ä¸ªintç±»å‹ï¼Œå¯ä»¥ç›´æ¥è·å–ã€‚èµ‹å€¼ç›´æ¥ä½¿ç”¨"),a("code",[t._v("=")]),t._v("å³å¯ã€‚")]),t._v(" "),a("p",[t._v("ç¬¦å·å€¼ï¼Œ é€šè¿‡"),a("code",[t._v("1dse.ir_arch.arch.regs.xx")]),t._v("è®¿é—®å¯„å­˜å™¨ï¼Œèµ‹å€¼é€šè¿‡"),a("code",[t._v("dse.update({..: ..})")]),t._v("èµ‹å€¼è¿›å»ä¸€ä¸ªç¬¦å·å€¼ã€‚è·å–é€šè¿‡"),a("code",[t._v("dse.eval_expr(xx)")]),t._v("ï¼Œ å³å¯è·å–å¯¹åº”å¸¦ç¬¦å·çš„è¡¨è¾¾å¼ã€‚")]),t._v(" "),a("h2",{attrs:{id:"bug"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bug"}},[t._v("#")]),t._v(" bug")]),t._v(" "),a("p",[t._v("å­¦ä¹ è¿‡ç¨‹ä¸­å‘ç°çš„ä»£ç ä¸Šçš„é—®é¢˜ï¼Œ ä¸»è¦æ˜¯é”™è¯¯å›æ˜¾ä¿¡æ¯æ²¡æ›´æ–°å¯¼è‡´æœ‰å‡ ä¸ªå°é—®é¢˜ï¼Œ")]),t._v(" "),a("p",[t._v("ä¸è¿‡ä¹Ÿä¸ä¸€å®šä¿®æ²¡ä¿®ï¼Œ è¿™ä¸ªæ¡†æ¶æ›´æ–°è¿˜æ˜¯æ¯”è¾ƒé¢‘ç¹çš„ï¼Œ")]),t._v(" "),a("h3",{attrs:{id:"get-str-ansi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-str-ansi"}},[t._v("#")]),t._v(" get_str_ansi")]),t._v(" "),a("p",[t._v("é¦–å…ˆæ˜¯"),a("code",[t._v("jitter.get_str_ansi(args.nptr)")]),t._v("è¿™ä¸ªå‡½æ•°å·²ç»ä¸å†æ”¯æŒï¼Œ è°ƒç”¨å°†ä¼šæŠ¥é”™ï¼Œ æç¤ºå»ä½¿ç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œæºç ä¸­å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# miasm/jitter/jitload.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_str_ansi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" max_char"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" NotImplementedError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Deprecated: use os_dep.win_api_x86_32.get_win_str_a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("ä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°ï¼Œåœ¨"),a("code",[t._v("miasm/os_dep/win_api_x86_32.py")]),t._v("ä¸­å¹¶æ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼Œ ä»–å·²ç»è¢«è½¬ç§»åˆ°äº†"),a("code",[t._v("miasm/os_dep/common.py")]),t._v("ä¸­ï¼Œ æºç ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# miasm/os_dep/common.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_win_str_a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ad_str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" max_char"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("å› æ­¤è¿™ä¸ªè°ƒç”¨åº”è¯¥ä¿®æ”¹ä¸ºï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" miasm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("os_dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("common  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" get_win_str_a\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\ncontent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_win_str_a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jitter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nptr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("åŒæ ·çš„get_str_unicå‡½æ•°ä¹Ÿæ˜¯ä¸€æ ·ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# miasm/jitter/jitload.py")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_str_unic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" max_char"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" NotImplementedError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Deprecated: use os_dep.win_api_x86_32.get_win_str_a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);