<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>miasm ä½¿ç”¨ç¬”è®° | Lingze&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="ctfer">
    <meta name="keywords" content="ctfer">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.415d0a97.css" as="style"><link rel="preload" href="/assets/js/app.01f8cc77.js" as="script"><link rel="preload" href="/assets/js/2.5ece5099.js" as="script"><link rel="preload" href="/assets/js/19.2d69c943.js" as="script"><link rel="prefetch" href="/assets/js/10.f923d8b8.js"><link rel="prefetch" href="/assets/js/100.cf64d3e9.js"><link rel="prefetch" href="/assets/js/11.19955ff8.js"><link rel="prefetch" href="/assets/js/12.e16d4c4d.js"><link rel="prefetch" href="/assets/js/13.0552f541.js"><link rel="prefetch" href="/assets/js/14.78d67d73.js"><link rel="prefetch" href="/assets/js/15.d342dfc4.js"><link rel="prefetch" href="/assets/js/16.36f247d6.js"><link rel="prefetch" href="/assets/js/17.031ae63f.js"><link rel="prefetch" href="/assets/js/18.7c49a89e.js"><link rel="prefetch" href="/assets/js/20.e845eb34.js"><link rel="prefetch" href="/assets/js/21.e398898d.js"><link rel="prefetch" href="/assets/js/22.6efd51e5.js"><link rel="prefetch" href="/assets/js/23.21d2b263.js"><link rel="prefetch" href="/assets/js/24.3231fe48.js"><link rel="prefetch" href="/assets/js/25.26e66a19.js"><link rel="prefetch" href="/assets/js/26.ddde99c2.js"><link rel="prefetch" href="/assets/js/27.f8e523dc.js"><link rel="prefetch" href="/assets/js/28.2c1ddb1d.js"><link rel="prefetch" href="/assets/js/29.f15cca3e.js"><link rel="prefetch" href="/assets/js/3.c087139c.js"><link rel="prefetch" href="/assets/js/30.2d433b5b.js"><link rel="prefetch" href="/assets/js/31.87dbaed0.js"><link rel="prefetch" href="/assets/js/32.045dc002.js"><link rel="prefetch" href="/assets/js/33.db01bde8.js"><link rel="prefetch" href="/assets/js/34.d177d280.js"><link rel="prefetch" href="/assets/js/35.360c2104.js"><link rel="prefetch" href="/assets/js/36.afbabc8a.js"><link rel="prefetch" href="/assets/js/37.8e60e299.js"><link rel="prefetch" href="/assets/js/38.c6a43a23.js"><link rel="prefetch" href="/assets/js/39.08102dc6.js"><link rel="prefetch" href="/assets/js/4.28fb810e.js"><link rel="prefetch" href="/assets/js/40.5767c7d7.js"><link rel="prefetch" href="/assets/js/41.307bcf10.js"><link rel="prefetch" href="/assets/js/42.daf03989.js"><link rel="prefetch" href="/assets/js/43.952d68dc.js"><link rel="prefetch" href="/assets/js/44.cbeef42b.js"><link rel="prefetch" href="/assets/js/45.fbd2a9f2.js"><link rel="prefetch" href="/assets/js/46.a92ae456.js"><link rel="prefetch" href="/assets/js/47.24f82953.js"><link rel="prefetch" href="/assets/js/48.fa3498f4.js"><link rel="prefetch" href="/assets/js/49.a64774f2.js"><link rel="prefetch" href="/assets/js/5.0660e0b3.js"><link rel="prefetch" href="/assets/js/50.d0ed88cd.js"><link rel="prefetch" href="/assets/js/51.50727b96.js"><link rel="prefetch" href="/assets/js/52.2756affe.js"><link rel="prefetch" href="/assets/js/53.2739f473.js"><link rel="prefetch" href="/assets/js/54.f0b71120.js"><link rel="prefetch" href="/assets/js/55.94d5a5ee.js"><link rel="prefetch" href="/assets/js/56.637c3b4a.js"><link rel="prefetch" href="/assets/js/57.7b7e3fee.js"><link rel="prefetch" href="/assets/js/58.812bae5d.js"><link rel="prefetch" href="/assets/js/59.70fe1d63.js"><link rel="prefetch" href="/assets/js/6.c52e1544.js"><link rel="prefetch" href="/assets/js/60.0e6a01d3.js"><link rel="prefetch" href="/assets/js/61.702e5198.js"><link rel="prefetch" href="/assets/js/62.38f55e44.js"><link rel="prefetch" href="/assets/js/63.b505c9de.js"><link rel="prefetch" href="/assets/js/64.5489c9d8.js"><link rel="prefetch" href="/assets/js/65.3db6e034.js"><link rel="prefetch" href="/assets/js/66.3605a461.js"><link rel="prefetch" href="/assets/js/67.00d97ed9.js"><link rel="prefetch" href="/assets/js/68.78ef741a.js"><link rel="prefetch" href="/assets/js/69.808ca1f4.js"><link rel="prefetch" href="/assets/js/7.9920c8ea.js"><link rel="prefetch" href="/assets/js/70.15347f58.js"><link rel="prefetch" href="/assets/js/71.b9acfd65.js"><link rel="prefetch" href="/assets/js/72.7e1140f3.js"><link rel="prefetch" href="/assets/js/73.874f0e99.js"><link rel="prefetch" href="/assets/js/74.117bb7d4.js"><link rel="prefetch" href="/assets/js/75.964e2dfe.js"><link rel="prefetch" href="/assets/js/76.2df26afd.js"><link rel="prefetch" href="/assets/js/77.93ebe7b7.js"><link rel="prefetch" href="/assets/js/78.67c6c9bb.js"><link rel="prefetch" href="/assets/js/79.0d846438.js"><link rel="prefetch" href="/assets/js/8.f3c32733.js"><link rel="prefetch" href="/assets/js/80.4716a5b6.js"><link rel="prefetch" href="/assets/js/81.d8c3b2d2.js"><link rel="prefetch" href="/assets/js/82.ea63e06a.js"><link rel="prefetch" href="/assets/js/83.4d1ef8ae.js"><link rel="prefetch" href="/assets/js/84.32a22fe7.js"><link rel="prefetch" href="/assets/js/85.7fb3f862.js"><link rel="prefetch" href="/assets/js/86.4d386fc9.js"><link rel="prefetch" href="/assets/js/87.a095878a.js"><link rel="prefetch" href="/assets/js/88.69d77356.js"><link rel="prefetch" href="/assets/js/89.21ebadb4.js"><link rel="prefetch" href="/assets/js/9.d8b27656.js"><link rel="prefetch" href="/assets/js/90.d49929b7.js"><link rel="prefetch" href="/assets/js/91.cc956227.js"><link rel="prefetch" href="/assets/js/92.b72e3535.js"><link rel="prefetch" href="/assets/js/93.a76f52a2.js"><link rel="prefetch" href="/assets/js/94.82a77dbd.js"><link rel="prefetch" href="/assets/js/95.b0cec47e.js"><link rel="prefetch" href="/assets/js/96.87307703.js"><link rel="prefetch" href="/assets/js/97.c731aa62.js"><link rel="prefetch" href="/assets/js/98.1e36c988.js"><link rel="prefetch" href="/assets/js/99.914f1e07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.415d0a97.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="Lingze's blog" class="logo"> <span class="site-name can-hide">Lingze's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/archives/" class="nav-link">timeline</a></div><div class="nav-item"><a href="/about.html" class="nav-link">about</a></div><div class="nav-item"><a href="/friends.html" class="nav-link">friends</a></div><div class="nav-item"><a href="/categories/" class="nav-link">categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">tags</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar2.jpg"> <div class="blogger-info"><h3>lingze</h3> <span>binä¸æ˜¯åƒåœ¾æ¡¶çš„æ„æ€!</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/archives/" class="nav-link">timeline</a></div><div class="nav-item"><a href="/about.html" class="nav-link">about</a></div><div class="nav-item"><a href="/friends.html" class="nav-link">friends</a></div><div class="nav-item"><a href="/categories/" class="nav-link">categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">tags</a></div> <!----></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/categories/?category=book" title="åˆ†ç±»" data-v-1baff76c>book</a></li><li data-v-1baff76c><a href="/categories/?category=reverse" title="åˆ†ç±»" data-v-1baff76c>reverse</a></li><li data-v-1baff76c><a href="/categories/?category=vm%E5%92%8C%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C" title="åˆ†ç±»" data-v-1baff76c>vmå’Œç¬¦å·æ‰§è¡Œ</a></li></ul> <div class="info" data-v-1baff76c><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://github.com/wlingze" target="_blank" title="ä½œè€…" class="beLink" data-v-1baff76c>lingze</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2020-07-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">miasm ä½¿ç”¨ç¬”è®°<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="miasm"><a href="#miasm" class="header-anchor">#</a> miasm</h2> <p>æœ€å¼€å§‹æ¥è§¦åˆ°æ˜¯åœ¨fcscçš„keykoololé¢˜ç›®wpä¸­ï¼Œ ä½¿ç”¨miasmå¤„ç†ä¸€ä¸ªvmï¼Œ åŒæ—¶è„šæœ¬ä¸­å¹¶æ²¡æœ‰å‡ºç°å¯¹äº255ä¸ªopcodeå¯¹åº”çš„è®¾ç½®ï¼Œä½†æ˜¯å´åƒä¸€ä¸ªåæ±‡ç¼–å™¨ä¸€æ ·ç›´æ¥æ‰“å°å‡ºç±»æ±‡ç¼–ä»£ç ï¼Œä¼¼ä¹æŒºç¥å¥‡ï¼Œ è€Œååœ¨tigressæŒ‘æˆ˜ä¸­çš„challenge0ä¹Ÿåœ¨å…¶å®˜æ–¹blogæœ‰å¯¹åº”wpï¼Œ äºæ˜¯å¼€å§‹å­¦ä¹ ï¼Œ</p> <p>è¿™ä¸ªæ¡†æ¶ç›®å‰ä¼¼ä¹è¿˜æ²¡æœ‰å¾ˆå®Œå¤‡çš„èµ„æ–™ï¼Œ å®˜æ–¹çš„blogç®€ä»‹äº†ä½¿ç”¨æ–¹å‘ï¼Œ ä½†æ˜¯å› ä¸ºç‰ˆæœ¬æ›´æ–°æœ‰äº›è„šæœ¬ç”šè‡³å‡ºç°äº†é—®é¢˜ï¼Œ</p> <p>ç¿»åˆ°äº†ä¸€ä¸ªè¿™ä¸ªï¼Œ <a href="https://miasmdoc.ajax.re/doxygen/html/namespacemiasm2.html" target="_blank" rel="noopener noreferrer">miasm - api<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä½†æ˜¯æ¯”è¾ƒè€ï¼Œè¿™ä¸ªæ¡†æ¶æ›´æ–°è¿˜æ˜¯æ¯”è¾ƒé¢‘ç¹ï¼Œ å¦å¤–å°±æ˜¯å¯¹ç…§<a href="https://github.com/cea-sec/miasm" target="_blank" rel="noopener noreferrer">æºç <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸­çš„æ³¨é‡Šè¿›è¡Œå­¦ä¹ ï¼Œ æ³¨é‡Šå€’æ˜¯æ¯”è¾ƒå¤šï¼Œ è€Œä¸”ä»£ç è´¨é‡æ„Ÿè§‰ä¹Ÿæ¯”è¾ƒä¸é”™ã€‚</p> <blockquote><p>è¿™ä¸ªæ¡†æ¶çš„å­¦ä¹ è¿‡ç¨‹ä¸­å¯¹äºæºç çš„ç¿»çœ‹æ›´å¤šäº†äº›ï¼Œ æ²¡æœ‰ä¸€äº›ç›¸å…³èµ„æ–™ï¼Œ ä½¿ç”¨èµ·æ¥çš„ä¸€äº›æŠ¥é”™ï¼Œ é€šè¿‡ç›´æ¥æŸ¥æ‰¾æºç ä¸­çš„æ³¨é‡Šå’Œå›æ˜¾ä¿¡æ¯ç­‰è¿›è¡Œè§£å†³ã€‚</p></blockquote> <p>é¦–å…ˆåº”è¯¥æ¯”è¾ƒä¸åŒçš„æ˜¯è¿™ä¸ªåŠ¨æ€ç¬¦å·æ‰§è¡ŒæŠ€æœ¯ï¼Œ å³æ··åˆä½¿ç”¨ç¬¦å·æ‰§è¡Œå’Œæ™®é€šçš„è¾“å…¥ç¡®å®šå€¼çš„è°ƒè¯•ï¼Œ</p> <p>ä¸»è¦æ€è·¯å¤§è‡´æ˜¯ï¼Œå› ä¸ºç¬¦å·æ‰§è¡Œä¼šå®¹æ˜“é€ æˆè·¯å¾„çˆ†ç‚¸çš„é—®é¢˜ï¼Œ äºæ˜¯æå‡ºï¼Œ å…ˆæ¨¡æ‹Ÿç¨‹åºçš„æ­£å¸¸æ‰§è¡Œï¼Œ ç„¶ååªåœ¨å…³é”®éœ€è¦çš„ä½ç½®æ’å…¥ç¬¦å·å¹¶åœ¨å¦ä¸€ç«¯çš„å¯¹åº”ä½ç½®å–å‡ºï¼Œ ç”±æ­¤é€šè¿‡è¾“å…¥çš„ç¡®å®šå€¼ä½¿å¾—è¿è¡Œè¿‡ç¨‹æ˜¯å›ºå®šçš„ï¼Œ ä¸ä¼šæœ‰è·¯å¾„çˆ†ç‚¸çš„æƒ…å†µï¼Œè€ŒåŒæ—¶ä½¿ç”¨ç¬¦å·è®°å½•è¿ç®—å¤„ç†è¿‡ç¨‹ï¼Œ æ ‡è®°è·¯å¾„ï¼Œ å¹¶è‡ªåŠ¨çš„é€šè¿‡å†…ç½®çš„irè½¬åŒ–ä¸ºç±»æ±‡ç¼–çš„è¯­è¨€ã€‚</p> <blockquote><p>å› æ­¤ï¼Œ è¿™ä¸ªè„šæœ¬å†™èµ·æ¥ï¼Œ æœ‰ç‚¹åƒida pythonåŠ¨è°ƒçš„è„šæœ¬ã€‚</p></blockquote> <h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="header-anchor">#</a> è¿è¡Œ</h2> <p>é¦–å…ˆæ˜¯è¦ä¿è¯ç¨‹åºåœ¨æ¡†æ¶ç»™å‡ºçš„ç¯å¢ƒå†…å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œ è¦è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼Œ è¿è¡Œè„šæœ¬å¹¶æŒ‡å®šå¯¹åº”ç¨‹åºï¼Œ é™¤äº†miasmæ¡†æ¶å¯¹åº”çš„æç¤ºä¿¡æ¯ï¼Œè¾“å…¥è¾“å‡ºè¿ç®—åˆ¤æ–­åº”è¯¥æ˜¯å’Œç›´æ¥è¿è¡Œç¨‹åºæ— äºŒã€‚</p> <h3 id="sandbox"><a href="#sandbox" class="header-anchor">#</a> sandbox</h3> <p>é¦–å…ˆæ˜¯ä¸€ä¸ªè¿è¡Œç¯å¢ƒçš„è®¾ç½®ï¼Œmiasm ä¸­ä½¿ç”¨sandboxçš„æ¦‚å¿µï¼Œï¼Œmiasmåœ¨<code>/miasm/analysis/sandbox.py</code>é¢„è®¾å¥½äº†ä»¥ä¸‹å‡ ä¸ªsandboxï¼š</p> <details class="custom-block details"><summary>details</summary> <ul><li>å¯¹äºlinuxç³»ç»Ÿï¼š
<ul><li>aarch64l</li> <li>armb_str</li> <li>arml_str</li> <li>arml</li> <li>armtl</li> <li>mips32b</li> <li>ppc32b</li> <li>x86_32</li> <li>x86_64</li></ul></li> <li>å¯¹äºwindowsç³»ç»Ÿï¼š
<ul><li>x86_64</li> <li>x86_32</li></ul></li></ul></details> <p>ä½¿ç”¨å°±å¦‚ä¸‹ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span>  miasm<span class="token punctuation">.</span>analysis<span class="token punctuation">.</span>sandbox <span class="token keyword">import</span> Sandbox_Linux_x86_64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç„¶åè¿›è¡Œç®€å•è®¾ç½®ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>parser <span class="token operator">=</span> Sandbox_Linux_x86_64<span class="token punctuation">.</span>parser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">&quot;ELF sandboxer&quot;</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">&quot;ELF Filename&quot;</span><span class="token punctuation">)</span>
options <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>

sb <span class="token operator">=</span> Sandbox_Linux_x86_64<span class="token punctuation">(</span>options<span class="token punctuation">.</span>filename<span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

sb<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>é¦–å…ˆæ˜¯è·å–parserå¯¹è±¡ï¼Œ å…¶ä½œç”¨æ˜¯å¤„ç†è¿è¡Œè„šæœ¬æ—¶çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œç„¶åä½¿ç”¨optionsè·å–åˆ°è§£æå‡ºå‘½ä»¤è¡Œå‚æ•°çš„namespaceï¼Œ ç„¶åè®¾ç½®å‡ºsandboxå¯¹è±¡ï¼Œå¹¶å¼€å§‹è¿è¡Œå³å¯ã€‚</p> <h3 id="æ•°æ®å’Œå†…å­˜å¤„ç†"><a href="#æ•°æ®å’Œå†…å­˜å¤„ç†" class="header-anchor">#</a> æ•°æ®å’Œå†…å­˜å¤„ç†</h3> <p>ä¸»è¦é€šè¿‡sandbox.jitterï¼Œ è¿™æ˜¯ä¸€ä¸ªjitterå¯¹è±¡ï¼Œ æ˜¯è¿è¡Œæ—¶å†…ç½®çš„ä¸€ä¸ªjit engineï¼Œ é€šè¿‡è¿™ä¸ªå¯ä»¥è®¿é—®å’Œä¿®æ”¹æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å†…å­˜ã€‚ ç›¸å…³çš„å‡½æ•°åœ¨pythonä¸­å®šä¹‰åœ¨<code>/miasm/jitter/jitload.py</code>ï¼Œ åŸºæœ¬ä¸Šå…¨éƒ¨ä¼šè½¬å…¥åˆ°jitter.vmå¯¹è±¡ï¼Œ è¿™ä¸ªå¯¹è±¡ä¸»è¦æ˜¯<code>/miasm/jitter/vm_mngr.c</code>, <code>/miasm/jitter/vm_mngr_py.c</code>ä¸­ï¼Œ</p> <p>å…¶ä¸­pythonä¸­å®šä¹‰çš„<code>jitter.get_c_str</code>å’Œ<code>jitter.set_c_str</code>éƒ½ä¼šè½¬åˆ°<code>jitter.vm.get_mem</code>å’Œ<code>jitter.vm.set_mem</code>ï¼Œ è¿™æ˜¯æœ€å¸¸ç”¨çš„å››ä¸ªï¼Œ ä¸€èˆ¬ç”¨åœ¨å¯¹libcå‡½æ•°çš„å®ç°ã€‚</p> <p>å¦å¤–å¯¹äºå†…å­˜é¡µç­‰çš„å®ç°ï¼Œ æœ‰<code>jitter.vm.add_memory_page</code>è¿›è¡Œå†…å­˜é¡µçš„è®¾ç½®ï¼Œ ä¸€èˆ¬å‡ºç°canaryçš„æ—¶å€™ä»fs[0x28]å–å€¼ï¼Œ å°†ä¼šä½¿ç”¨è¿™ä¸ªå¤„ç†ï¼Œä¸ç„¶ç¨‹åºæ— æ³•è®¿é—®åˆ°fs[0x28]çš„ä½ç½®ã€‚</p> <h3 id="å®ç°-libc"><a href="#å®ç°-libc" class="header-anchor">#</a> å®ç° libc</h3> <div class="custom-block warning"><p class="custom-block-title">warning</p> <p>å’Œangrç±»ä¼¼ï¼Œ è¿™ä¸ªç¨‹åºè¿è¡Œåœ¨pythonçš„miasmæ¡†æ¶çš„ç¯å¢ƒå†…ï¼Œå¦‚æœä»–è°ƒç”¨äº†libcå‡½æ•°ï¼Œéƒ½æ— æ³•æ‰¾åˆ°ï¼Œ å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨miasmç¯å¢ƒä¸­æ„é€ è¿™ä¸ªå‡½æ•°ï¼Œåœ¨miasmä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è„šæœ¬ä¸­è®¾ç½®ä¸€ä¸ªå¯¹åº”çš„å‡½æ•°å³å¯ï¼Œè¿è¡Œæ—¶ä¼šè‡ªåŠ¨å¯»æ‰¾å’Œè°ƒç”¨ã€‚</p> <p>ç›®å‰åº”è¯¥<code>__libc_start_main</code>è¿˜æœ‰å‡ ä¸ªä¸éœ€è¦ï¼Œ</p> <p>å¯ä»¥ç›´æ¥è¿è¡Œï¼Œ çœ‹æŠ¥é”™æç¤ºç¼ºå°‘ï¼Œ å†ä¿®å¤å‡ ä¸ªï¼Œ</p></div> <p>åœ¨miasmä¸­å·²ç»å®ç°äº†å¥½å‡ ä¸ªï¼Œä½ç½®åœ¨<code>/miasm/os_dep/linux_stdlib.py</code>ï¼Œ å¯ä»¥<code>import Ã—</code>è¿›æ¥ï¼Œ ä½†æ˜¯å¯èƒ½ä¹Ÿä¼šå› ä¸ºå‡½æ•°åå’Œæå–å‚æ•°å•¥çš„ä¸å¯¹ï¼Œ</p> <p>è¿™é‡Œç®€å•è¯´æ˜å‡ ä¸ªlibcå‡½æ•°çš„æ„é€ ï¼Œ</p> <p>é¦–å…ˆä¼ å…¥å‡½æ•°çš„åº”è¯¥æ˜¯<code>jitter</code>ï¼Œ è¿™ä¸ªæˆ‘ä»¬å‰é¢è¯´é“çš„è·å–å­—ç¬¦ä¸²æˆ–è€…å†…å­˜å•¥çš„ï¼Œä¹ŸåŸºæœ¬éƒ½æ˜¯åœ¨è¿™é‡Œä½¿ç”¨çš„ã€‚</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> xxx_<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>jitter<span class="token punctuation">)</span>
	ret_ad<span class="token punctuation">,</span> args <span class="token operator">=</span> jitter<span class="token punctuation">.</span>func_args_systemv<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> jitter<span class="token punctuation">.</span>func_ret_systemv<span class="token punctuation">(</span><span class="token punctuation">[</span>ret_ad<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä¸€èˆ¬ä¸€ä¸ªæ¨¡æ‹Ÿlibcå‡½æ•°åº”è¯¥å¦‚ä¸Šç¤ºï¼Œ</p> <p>å…³äºå‡½æ•°å¯¹åº”çš„å‚æ•°å’Œè¿”å›å€¼çš„è·å–å’Œè®¾ç½®ï¼Œ ä¸­é—´è¿›è¡Œæ•°æ®å¤„ç†ï¼Œ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¹Ÿå¹¶ä¸éœ€è¦ç¼–å†™éå¸¸å®Œå¤‡çš„å‡½æ•°åŠŸèƒ½ï¼Œ åªè¦ç¬¦åˆå½“å‰ç¨‹åºåº”è¯¥è¿è¡Œçš„çŠ¶æ€å³å¯ï¼Œ</p> <div class="custom-block tip"><p class="custom-block-title">tip</p> <p>æ¯”å¦‚åœ¨æœ‰äº›ç¨‹åºé‡Œï¼Œ printfé‡Œä»æ²¡æœ‰å‡ºç°æ ¼å¼åŒ–å­—ç¬¦ä¸²+å‚æ•°çš„å½¢å¼ï¼Œ é‚£å°±å¯ä»¥åœ¨å®ç°çš„æ—¶å€™å½“ä½œä¸€ä¸ªputsä¹‹ç±»çš„ï¼Œ ç®€å•å®ç°å…¶åŠŸèƒ½ï¼Œ</p></div> <p>å…·ä½“çš„ä¾‹å­å¯ä»¥ç¿»çœ‹<code>linux_stdlib.py</code>æ–‡ä»¶ä¸­ï¼Œæˆ–è€…åœ¨å®é™…æ“ä½œä¸­çš„è„šæœ¬ï¼Œ</p> <details class="custom-block details"><summary>details</summary> <p>è¿™é‡Œç®€å•ä¾‹å­:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">xxx_fgets</span><span class="token punctuation">(</span>jitter<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">'''
		åŸå‹ï¼š char *fgets(char *str, int n, FILE *stream)
		åœ¨ç¨‹åºä¸­streamä¸€ç›´ä¸ºstdin, å› æ­¤ç›´æ¥ç”¨inputäº†ï¼Œ 
	'''</span>
    ret_ad<span class="token punctuation">,</span> args <span class="token operator">=</span> jitter<span class="token punctuation">.</span>func_args_systemv<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;dest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;size&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;stream&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    s <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    jitter<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>set_mem<span class="token punctuation">(</span>args<span class="token punctuation">.</span>dest<span class="token punctuation">,</span> s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> jitter<span class="token punctuation">.</span>func_ret_systemv<span class="token punctuation">(</span>ret_ad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">xxx___printf_chk</span><span class="token punctuation">(</span>jitter<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    	åŸå‹ï¼šint printf(const char *format, ...)
    	å€¼å¾—æ³¨æ„çš„æ˜¯å‚æ•°é‡Œçš„'s'ï¼Œ å¿…é¡»åŠ ä¸Šå°±æ­£ç¡®äº†ï¼Œ ä½†æ˜¯ä¸æ¸…æ¥šå•¥åŸå› ã€‚
    '''</span>
    ret_ad<span class="token punctuation">,</span> args <span class="token operator">=</span> jitter<span class="token punctuation">.</span>func_args_systemv<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">&quot;format&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;arg&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>jitter<span class="token punctuation">.</span>get_c_str<span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> jitter<span class="token punctuation">.</span>func_ret_systemv<span class="token punctuation">(</span>ret_ad<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></details> <h3 id="å‘½ä»¤è¡Œå‚æ•°"><a href="#å‘½ä»¤è¡Œå‚æ•°" class="header-anchor">#</a> å‘½ä»¤è¡Œå‚æ•°</h3> <p>å¯¹äºç¨‹åºè¿è¡Œæ—¶éœ€è¦å‘½ä»¤è¡Œè¾“å…¥çš„å‚æ•°ï¼Œ</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>options<span class="token punctuation">.</span>mimic_env <span class="token operator">=</span> Ture
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿™ä¸ªå˜é‡æ˜¯åœ¨Sandbox_Linux_x86_64å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶è·å–å‘½ä»¤è¡Œå‚æ•°ï¼Œå‹å…¥æ ˆä¸­ã€‚<a href="https://github.com/cea-sec/miasm/blob/master/miasm/analysis/sandbox.py#L641" target="_blank" rel="noopener noreferrer">åœ¨è¿™é‡Œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>,</p> <p>ç„¶åè¾“å…¥å‘½ä»¤è¡Œå‚æ•°ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>options<span class="token punctuation">.</span>command_line <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'....'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="å†…å­˜æ®µ"><a href="#å†…å­˜æ®µ" class="header-anchor">#</a> å†…å­˜æ®µ</h3> <p>ä¸€èˆ¬ä½¿ç”¨æ ˆç­‰éƒ½ä¸ä¼šæœ‰å¤ªå¤§é—®é¢˜ï¼Œ ä½†æ˜¯å½“ç¨‹åºä½¿ç”¨canaryæ—¶ï¼Œ å°†ä¼šå¯¼è‡´é—®é¢˜ï¼Œ äºæ˜¯æˆ‘ä»¬è¦æ‰‹åŠ¨è®¾ç½®fsçš„å†…å­˜å’Œcanaryæ‰€å–çš„ fs[0x28]ä½ç½®çš„æ•°æ®ï¼Œ</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> miasm<span class="token punctuation">.</span>jitter<span class="token punctuation">.</span>csts      <span class="token keyword">import</span> PAGE_READ


sb<span class="token punctuation">.</span>jitter<span class="token punctuation">.</span>ir_arch<span class="token punctuation">.</span>do_all_segm <span class="token operator">=</span> <span class="token boolean">True</span>
FS_0_ADDR <span class="token operator">=</span> <span class="token number">0x7ff70000</span>
sb<span class="token punctuation">.</span>jitter<span class="token punctuation">.</span>cpu<span class="token punctuation">.</span>FS <span class="token operator">=</span> <span class="token number">0x4</span>
sb<span class="token punctuation">.</span>jitter<span class="token punctuation">.</span>cpu<span class="token punctuation">.</span>set_segm_base<span class="token punctuation">(</span>sb<span class="token punctuation">.</span>jitter<span class="token punctuation">.</span>cpu<span class="token punctuation">.</span>FS<span class="token punctuation">,</span> FS_0_ADDR<span class="token punctuation">)</span>
sb<span class="token punctuation">.</span>jitter<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>add_memory_page<span class="token punctuation">(</span>FS_0_ADDR <span class="token operator">+</span> <span class="token number">0x28</span><span class="token punctuation">,</span> PAGE_READ<span class="token punctuation">,</span> <span class="token string">b&quot;\x42\x42\x42\x42\x42\x42\x42\x42&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Stack canary FS[0x28]&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>åœ¨<code>miasm.jitter.csts</code>ä¸­å®šä¹‰çš„éƒ½æ˜¯ä¸€å †çš„å…³äºæƒé™æ§åˆ¶ç­‰å¸¸é‡ï¼Œ</p> <h2 id="dse-æŠ€æœ¯"><a href="#dse-æŠ€æœ¯" class="header-anchor">#</a> dse æŠ€æœ¯</h2> <p>å½“æˆ‘ä»¬å·²ç»æˆåŠŸå¯ä»¥è®©ç¨‹åºæ­£å¸¸çš„åœ¨miasmç¯å¢ƒä¸­è¿è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥å¼€å§‹è€ƒè™‘åŠ å…¥dse engineï¼Œ</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> miasm<span class="token punctuation">.</span>analysis<span class="token punctuation">.</span>dse <span class="token keyword">import</span> DSEEngine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="åˆå§‹åŒ–å’Œè®¾ç½®dse"><a href="#åˆå§‹åŒ–å’Œè®¾ç½®dse" class="header-anchor">#</a> åˆå§‹åŒ–å’Œè®¾ç½®dse</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dse <span class="token operator">=</span> DSEEngine<span class="token punctuation">(</span>sb<span class="token punctuation">.</span>machine<span class="token punctuation">)</span>

dse<span class="token punctuation">.</span>add_lib_handler<span class="token punctuation">(</span>sb<span class="token punctuation">.</span>libs<span class="token punctuation">,</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>è¿™ä¸ªdse engineå¯¹è±¡å®šä¹‰åœ¨<code>/miasm/analysis/dse.py</code>ï¼Œ åˆå§‹åŒ–ä¼ å…¥sandboxå†…å¯¹åº”çš„machineå±æ€§å³å¯ï¼Œ</p> <p>æ³¨æ„è¿™ä¸ª<code>dse.add_lib_handler(sb.libs, globals())</code>æ–¹æ³•ï¼Œ ä½œç”¨æ˜¯è½½å…¥dseåï¼Œ æ‰€æœ‰çš„libcå‡½æ•°ï¼Œ å¦‚å‡½æ•°<code>{name}</code>, è®¾ç½®åˆ°å¯¹åº”çš„<code>{name}_symb</code>å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰æŸ¥æ‰¾åˆ°å¯¹åº”çš„<code>{name}_symb</code>ï¼Œ åˆ™ä¼šè®¾ç½®åˆ°<a href="https://github.com/cea-sec/miasm/blob/master/miasm/analysis/dse.py#L260" target="_blank" rel="noopener noreferrer"><code>default_func</code>å‡½æ•°<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, æç¤ºè¿™ä¸ªå‡½æ•°ä¸å­˜åœ¨ï¼Œéœ€è¦å®šä¹‰ã€‚</p> <p>æ³¨æ„è¿™é‡Œè®¾ç½®çš„æ˜¯handlerï¼Œ æœ€å<code>add_lib_handler</code>ä¼šè§£æå‡ºåå­—ä»¥åè°ƒç”¨<code>add_handler</code>è®¾ç½®ï¼Œ</p> <h3 id="dse-attachåˆ°jitter"><a href="#dse-attachåˆ°jitter" class="header-anchor">#</a> dse attachåˆ°jitter</h3> <p>å®šä¹‰å¥½dseå¯¹è±¡ä»¥åï¼Œè¿è¡Œä»ç„¶æ˜¯è€æ ·å­ï¼Œè¦æƒ³å¼€å§‹è®°å½•ç¬¦å·åº”è¯¥ä½¿ç”¨:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dse<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>jitter<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿™ä¸€å¥å¼€å§‹æˆ‘ä»¬çš„dseå¯¹è±¡æ‰ä¼šæŠ•å…¥ä½¿ç”¨ï¼Œè€Œä¸”è¿™ä»¥åçš„è°ƒç”¨libcéƒ½ä¼šæ˜¯è°ƒç”¨å¯¹åº”çš„<code>{name}_symb</code>å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰çš„è¯ä¹Ÿä¼šå¼€å§‹çœ‹åˆ°ç›¸å…³æŠ¥é”™äº†ã€‚</p> <p>å…³äºè¿™ä¸€å¥çš„ä½ç½®ï¼Œå®šä¹‰å¥½dseä»¥åå°±å¯ä»¥ä½¿ç”¨attachï¼Œä½†æ˜¯ä¸€èˆ¬ä½¿ç”¨åœ¨å…³é”®ä½ç½®é™„è¿‘çš„libcå‡½æ•°è®¾ç½®ä¸€ä¸ªï¼Œ åœ¨å‡½æ•°å†…ä½¿ç”¨å¯ä»¥åŠ ä¸€ä¸ª<code>global dse</code>ã€‚</p> <h3 id="instrumentationå’Œhandlerç›¸å…³"><a href="#instrumentationå’Œhandlerç›¸å…³" class="header-anchor">#</a> instrumentationå’Œhandlerç›¸å…³</h3> <p>è®¾ç½®å¥½dseå’Œattachä»¥åå¯ä»¥å¼€å§‹è®¾ç½®ä½¿ç”¨instrumentationå’Œhandlerï¼Œè¿™æ˜¯dseå¯¹è±¡å†…çš„ä¸¤ä¸ªå­—å…¸ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># /miasm/analysis/dse.py </span>
<span class="token comment"># class DSEEnigne </span>
<span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	self<span class="token punctuation">.</span>handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment"># addr -&gt; callback(DSEEngine instance)</span>
	self<span class="token punctuation">.</span>instrumentation <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment"># addr -&gt; callback(DSEEngine instance)</span>

<span class="token keyword">def</span> <span class="token function">add_handler</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Add a @callback for address @addr before any state update.
    The state IS NOT updated after returning from the callback
    @addr: int
    @callback: func(dse instance)&quot;&quot;&quot;</span>
    self<span class="token punctuation">.</span>handler<span class="token punctuation">[</span>addr<span class="token punctuation">]</span> <span class="token operator">=</span> callback

<span class="token keyword">def</span> <span class="token function">add_instrumentation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;Add a @callback for address @addr before any state update.
    The state IS updated after returning from the callback
    @addr: int
    @callback: func(dse instance)&quot;&quot;&quot;</span>
    self<span class="token punctuation">.</span>instrumentation<span class="token punctuation">[</span>addr<span class="token punctuation">]</span> <span class="token operator">=</span> callback
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>é‡Œé¢å‚¨å­˜çš„æ˜¯åœ°å€å’Œå¯¹åº”è°ƒç”¨çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬ä¸­è®¾ç½®å¥½ä¸€ä¸ªå‡½æ•°ï¼Œ ç„¶åä½¿ç”¨<code>dse.add_instrumentation</code>æˆ–<code>dse.add_handler</code>è®¾ç½®åœ°å€å’Œè¿™ä¸ªå‡½æ•°ï¼Œ</p> <p>è¿™ä¸¤ä¸ªå­—å…¸çš„ä½¿ç”¨çœ‹èµ·æ¥åŸºæœ¬ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯handleä¸ä¼šåˆ·æ–°çŠ¶æ€ï¼Œ instrumentationä¼šåˆ·æ–°çŠ¶æ€,</p> <div class="custom-block warning"><p class="custom-block-title">warning</p> <p>å å‘</p> <p>ç›®å‰ä¸å¤ªæ¸…æ¥šè¿™ä¸ªå…³äºçŠ¶æ€åˆ·æ–°çš„æ³¨é‡Šå•¥æ„æ€ğŸ˜… ğŸ˜…ğŸ˜…</p> <p>ä¸è¿‡çœ‹åˆ°ç›¸å…³å‡ ä¸ªä¾‹å­ï¼Œ ä¸€èˆ¬æ‰‹åŠ¨è®¾ç½®ç¨‹åºä¸­çš„æŸäº›ä½ç½®çš„æ—¶å€™ä¼¼ä¹éƒ½æ˜¯ä½¿ç”¨instrumentationï¼Œ</p> <p>å½“ç„¶ï¼Œè¿˜æœ‰ä¸ªupdate_stateçš„æ–¹æ³•ï¼Œ ä½†æ˜¯çœ‹èµ·æ¥å¹¶ä¸ä¸€æ ·...</p></div> <details class="custom-block details"><summary>details</summary> <p>ç›®å‰å·²ç»çœ‹åˆ°çš„ï¼Œ jitterä¸­è¿è¡Œåˆ°å¯¹åº”ä¸€äº›ä½ç½®åº”è¯¥æ˜¯å›å»è°ƒç”¨dseå¯¹è±¡çš„<a href="https://github.com/cea-sec/miasm/blob/master/miasm/analysis/dse.py#L320" target="_blank" rel="noopener noreferrer">callbackå‡½æ•°<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œå…¶ä¸­ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># /miasm/analysis/dse.py</span>
<span class="token comment"># class DSEEinge</span>
<span class="token comment">#     def callback():</span>
<span class="token keyword">if</span> cur_addr <span class="token keyword">in</span> self<span class="token punctuation">.</span>handler<span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>handler<span class="token punctuation">[</span>cur_addr<span class="token punctuation">]</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

<span class="token keyword">if</span> cur_addr <span class="token keyword">in</span> self<span class="token punctuation">.</span>instrumentation<span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>instrumentation<span class="token punctuation">[</span>cur_addr<span class="token punctuation">]</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>è¿™é‡Œæ˜¯å…³äºè¿è¡Œè®¾ç½®å¥½çš„å‡½æ•°çš„ä½ç½®ï¼Œ å› æ­¤å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è®¾ç½®çš„å‡½æ•°åº”è¯¥å‚æ•°ä¸ºdseå¯¹è±¡ï¼Œ</p> <p>å¦å¤–ä¸€ç‚¹å°±æ˜¯åœ¨handlerè¿è¡Œåç›´æ¥returnï¼Œ ä½†æ˜¯å¯¹äºinstrumentationè¿è¡Œåç»§ç»­è¿è¡Œäº†åé¢çš„éƒ¨åˆ†åœ¨æœ€åè¿›è¡Œè¿”å›ï¼Œè¿™åº”è¯¥å°±æ˜¯ä¸¤è€…çš„å·®åˆ«ä½ç½®ï¼Œä¹Ÿæ˜¯å…³äºçŠ¶æ€åˆ·æ–°ä¹‹ç±»çš„ã€‚</p></details> <h3 id="ç¬¦å·åŒ–-å’Œ-çŠ¶æ€åˆ·æ–°"><a href="#ç¬¦å·åŒ–-å’Œ-çŠ¶æ€åˆ·æ–°" class="header-anchor">#</a> ç¬¦å·åŒ– å’Œ çŠ¶æ€åˆ·æ–°</h3> <p>ç±»ä¼¼z3ä¸­è®¾ç½®ç¬¦å·çš„æ–¹å¼ï¼Œ miasmä¸­ä½¿ç”¨<code>Expr</code>ç³»åˆ—çš„å¯¹è±¡ï¼Œæ˜¯miasmä¸­çš„irä¸­é—´è¯­è¨€çš„è¡¨ç¤ºï¼Œ</p> <p>ä¸€èˆ¬è¿™æ ·ä¸€ä¸ªå¯¹è±¡è¡¨ç¤ºä¸€ä¸ªç¬¦å·åŒ–çš„å˜é‡ï¼Œé€šè¿‡<code>dse.update_state()</code>æ–¹æ³•æ’å…¥åˆ°ç¨‹åºä¸­ï¼Œé€šè¿‡<code>dse.eval_expr()</code>æ–¹æ³•è·å–è¾“å…¥åçš„å·²ç»è®°å½•äº†è¿ç®—çš„ä¸€ä¸ªå¸¦ç¬¦å·è¡¨è¾¾å¼ï¼Œ</p> <p>æ³¨æ„åœ¨æ’å…¥æ‰€æœ‰ç¬¦å·å‰ï¼Œ åº”è¯¥åœ¨attachä»¥åï¼Œä½¿ç”¨<code>dse.update_state_from_concrete()</code>ï¼Œ ä»åŸæœ¬çš„ç”±ç¡®å®šå€¼è¿è¡Œçš„ç¯å¢ƒä¸­è½½å…¥åˆ°dseç¯å¢ƒã€‚</p> <div class="custom-block tip"><p class="custom-block-title">tip</p> <p>æœ€ç®€å•çš„ä¸€ä¸ªç¤ºä¾‹æ˜¯miasm-blogä¸­çš„tigress0-challenge0çš„å¤„ç†ï¼Œåœ¨æ–‡ç« <a href="https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html" target="_blank" rel="noopener noreferrer">Playing with Dynamic symbolic execution<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>æˆ‘ä¸‹ä¸€æ­¥ä¹Ÿå°†ä¼šåœ¨åšå®¢çš„wpåŒº, tigress0-0ä¸­å†™ä¸Šå¯¹åº”çš„wp</p></div> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dse<span class="token punctuation">.</span>update_state_from_concrete<span class="token punctuation">(</span><span class="token punctuation">)</span>
dse<span class="token punctuation">.</span>update_state<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

dse<span class="token punctuation">.</span>exal_expr<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="è·å–å’Œè®¾ç½®å¯„å­˜å™¨"><a href="#è·å–å’Œè®¾ç½®å¯„å­˜å™¨" class="header-anchor">#</a> è·å–å’Œè®¾ç½®å¯„å­˜å™¨</h3> <p>åœ¨åŠ å…¥dseä»¥åï¼Œç¯å¢ƒä¸­ä¸€å…±å­˜åœ¨ä¸¤å¥—æ•°æ®ï¼Œ ä¸€ä¸ªæ˜¯åŸæœ¬çš„å…·ä½“å€¼ï¼Œ ä¸€ä¸ªæ˜¯ç¬¦å·åŒ–çš„æ•°æ®ã€‚</p> <p>å…·ä½“å€¼ï¼Œé€šè¿‡<code>dse.jitter.cpu.xx</code>è®¿é—®å¯„å­˜å™¨ï¼Œ æˆ–è€…<code>sb.jitter.cpu.xx</code>è¿™ä¸¤ä¸ªæ˜¯ç­‰åŒçš„ã€‚ è¿”å›å€¼æ˜¯ä¸€ä¸ªintç±»å‹ï¼Œå¯ä»¥ç›´æ¥è·å–ã€‚èµ‹å€¼ç›´æ¥ä½¿ç”¨<code>=</code>å³å¯ã€‚</p> <p>ç¬¦å·å€¼ï¼Œ é€šè¿‡<code>1dse.ir_arch.arch.regs.xx</code>è®¿é—®å¯„å­˜å™¨ï¼Œèµ‹å€¼é€šè¿‡<code>dse.update({..: ..})</code>èµ‹å€¼è¿›å»ä¸€ä¸ªç¬¦å·å€¼ã€‚è·å–é€šè¿‡<code>dse.eval_expr(xx)</code>ï¼Œ å³å¯è·å–å¯¹åº”å¸¦ç¬¦å·çš„è¡¨è¾¾å¼ã€‚</p> <h2 id="bug"><a href="#bug" class="header-anchor">#</a> bug</h2> <p>å­¦ä¹ è¿‡ç¨‹ä¸­å‘ç°çš„ä»£ç ä¸Šçš„é—®é¢˜ï¼Œ ä¸»è¦æ˜¯é”™è¯¯å›æ˜¾ä¿¡æ¯æ²¡æ›´æ–°å¯¼è‡´æœ‰å‡ ä¸ªå°é—®é¢˜ï¼Œ</p> <p>ä¸è¿‡ä¹Ÿä¸ä¸€å®šä¿®æ²¡ä¿®ï¼Œ è¿™ä¸ªæ¡†æ¶æ›´æ–°è¿˜æ˜¯æ¯”è¾ƒé¢‘ç¹çš„ï¼Œ</p> <h3 id="get-str-ansi"><a href="#get-str-ansi" class="header-anchor">#</a> get_str_ansi</h3> <p>é¦–å…ˆæ˜¯<code>jitter.get_str_ansi(args.nptr)</code>è¿™ä¸ªå‡½æ•°å·²ç»ä¸å†æ”¯æŒï¼Œ è°ƒç”¨å°†ä¼šæŠ¥é”™ï¼Œ æç¤ºå»ä½¿ç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œæºç ä¸­å¦‚ä¸‹ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># miasm/jitter/jitload.py</span>
<span class="token keyword">def</span> <span class="token function">get_str_ansi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> max_char<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> NotImplementedError<span class="token punctuation">(</span><span class="token string">&quot;Deprecated: use os_dep.win_api_x86_32.get_win_str_a&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°ï¼Œåœ¨<code>miasm/os_dep/win_api_x86_32.py</code>ä¸­å¹¶æ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼Œ ä»–å·²ç»è¢«è½¬ç§»åˆ°äº†<code>miasm/os_dep/common.py</code>ä¸­ï¼Œ æºç ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># miasm/os_dep/common.py</span>
<span class="token keyword">def</span> <span class="token function">get_win_str_a</span><span class="token punctuation">(</span>jitter<span class="token punctuation">,</span> ad_str<span class="token punctuation">,</span> max_char<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å› æ­¤è¿™ä¸ªè°ƒç”¨åº”è¯¥ä¿®æ”¹ä¸ºï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> miasm<span class="token punctuation">.</span>os_dep<span class="token punctuation">.</span>common  <span class="token keyword">import</span> get_win_str_a

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
content <span class="token operator">=</span> get_win_str_a<span class="token punctuation">(</span>jitter<span class="token punctuation">,</span> args<span class="token punctuation">.</span>nptr<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>åŒæ ·çš„get_str_unicå‡½æ•°ä¹Ÿæ˜¯ä¸€æ ·ï¼š</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># miasm/jitter/jitload.py</span>
<span class="token keyword">def</span> <span class="token function">get_str_unic</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> max_char<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> NotImplementedError<span class="token punctuation">(</span><span class="token string">&quot;Deprecated: use os_dep.win_api_x86_32.get_win_str_a&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=miasm" title="æ ‡ç­¾">#miasm</a><a href="/tags/?tag=dse" title="æ ‡ç­¾">#dse</a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2/24/2021, 2:44:29 PM</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:wl200103124@163.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/wlingze" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://blog.csdn.net/wlz_lc_4" title="csdn" target="_blank" class="iconfont icon-csdn"></a><a href="https://www.zhihu.com/people/wlingze" title="zhihu" target="_blank" class="iconfont icon-zhihu"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2019-2022
    <span>lingze | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.01f8cc77.js" defer></script><script src="/assets/js/2.5ece5099.js" defer></script><script src="/assets/js/19.2d69c943.js" defer></script>
  </body>
</html>
